/*! @azure/msal-browser v2.3.0 2020-10-20 */
"use strict";!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).msal={})}(this,function(y){var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function e(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var c=function(){return(c=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function p(i,s,a,c){return new(a=a||Promise)(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,s||[])).next())})}function f(r,n){var o,i,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}var o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function t(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var d=function(){return(d=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function m(i,s,a,c){return new(a=a||Promise)(function(e,t){function r(e){try{o(c.next(e))}catch(e){t(e)}}function n(e){try{o(c.throw(e))}catch(e){t(e)}}function o(t){t.done?e(t.value):new a(function(e){e(t.value)}).then(r,n)}o((c=c.apply(i,s||[])).next())})}function g(r,n){var o,i,s,e,a={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(o)throw new TypeError("Generator is already executing.");for(;a;)try{if(o=1,i&&(s=2&t[0]?i.return:t[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,t[1])).done)return s;switch(i=0,s&&(t=[2&t[0],s.value]),t[0]){case 0:case 1:s=t;break;case 4:return a.label++,{value:t[1],done:!1};case 5:a.label++,i=t[1],t=[0];continue;case 7:t=a.ops.pop(),a.trys.pop();continue;default:if(!(s=0<(s=a.trys).length&&s[s.length-1])&&(6===t[0]||2===t[0])){a=0;continue}if(3===t[0]&&(!s||t[1]>s[0]&&t[1]<s[3])){a.label=t[1];break}if(6===t[0]&&a.label<s[1]){a.label=s[1],s=t;break}if(s&&a.label<s[2]){a.label=s[2],a.ops.push(t);break}s[2]&&a.ops.pop(),a.trys.pop();continue}t=n.call(r,a)}catch(e){t=[6,e],i=0}finally{o=s=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}}function i(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}var s,r={unexpectedError:{code:"unexpected_error",desc:"Unexpected error in authentication."}},a=(t(u,s=Error),u.createUnexpectedError=function(e){return new u(r.unexpectedError.code,r.unexpectedError.desc+": "+e)},u);function u(e,t,r){var n=this,o=t?e+": "+t:e;return n=s.call(this,o)||this,Object.setPrototypeOf(n,u.prototype),n.errorCode=e,n.errorMessage=t,n.suberror=r,n.name="AuthError",n}var h,l="1.5.0",E=l,v={code:"client_info_decoding_error",desc:"The client info could not be parsed/decoded correctly. Please review the trace to determine the root cause."},C={code:"client_info_empty_error",desc:"The client info was empty. Please review the trace to determine the root cause."},T={code:"token_parsing_error",desc:"Token cannot be parsed. Please review stack trace to determine root cause."},w={code:"null_or_empty_token",desc:"The token is null or empty. Please review the trace to determine the root cause."},I={code:"endpoints_resolution_error",desc:"Error: could not resolve endpoints. Please check network and try again."},A={code:"invalid_authority_type",desc:"The given authority is not a valid type of authority supported by MSAL. Please review the trace to determine the root cause."},S={code:"hash_not_deserialized",desc:"The hash parameters could not be deserialized. Please review the trace to determine the root cause."},R={code:"invalid_state",desc:"State was not the expected format. Please check the logs to determine whether the request was sent using ProtocolUtils.setRequestState()."},_={code:"state_mismatch",desc:"State mismatch error. Please check your network. Continued requests may cause cache overflow."},O={code:"nonce_mismatch",desc:"Nonce mismatch error. This may be caused by a race condition in concurrent requests."},b={code:"account_mismatch",desc:"The cached account and account which made the token request do not match."},N={code:"no_tokens_found",desc:"No tokens were found for the given scopes, and no authorization code was passed to acquireToken. You must retrieve an authorization code before making a call to acquireToken()."},k={code:"cache_parse_error",desc:"Could not parse cache key."},P={code:"user_login_error",desc:"User login is required."},U={code:"multiple_matching_tokens",desc:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account."},L={code:"multiple_matching_accounts",desc:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account"},M={code:"request_cannot_be_made",desc:"Token request cannot be made without authorization code or refresh token."},D={code:"cannot_append_empty_scope",desc:"Cannot append null or empty scope to ScopeSet. Please check the stack trace for more info."},q={code:"cannot_remove_empty_scope",desc:"Cannot remove null or empty scope from ScopeSet. Please check the stack trace for more info."},H={code:"cannot_append_scopeset",desc:"Cannot append ScopeSet due to error."},K={code:"empty_input_scopeset",desc:"Empty input ScopeSet cannot be processed."},x={code:"device_code_polling_cancelled",desc:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true."},F={code:"device_code_expired",desc:"Device code is expired."},G={code:"no_account_in_silent_request",desc:"Please pass an account object, silent flow is not supported without account information"},j={code:"invalid_cache_record",desc:"Cache record object was null or undefined."},B={code:"invalid_cache_environment",desc:"Invalid environment when attempting to create cache entry"},Y={code:"no_account_found",desc:"No account found in cache for given key."},z={code:"no cache plugin set on CacheManager",desc:"ICachePlugin needs to be set before using readFromStorage or writeFromStorage"},V={code:"no_crypto_object",desc:"No crypto object detected. This is required for the following operation: "},W={code:"invalid_cache_type",desc:"Invalid cache type"},J={code:"unexpected_account_type",desc:"Unexpected account type."},Q={code:"unexpected_credential_type",desc:"Unexpected credential type."},X={code:"invalid_assertion",desc:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515"},Z={code:"invalid_client_credential",desc:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential"},$={code:"token_refresh_required",desc:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired."},ee=(t(te,h=a),te.createClientInfoDecodingError=function(e){return new te(v.code,v.desc+" Failed with error: "+e)},te.createClientInfoEmptyError=function(e){return new te(C.code,C.desc+" Given Object: "+e)},te.createTokenParsingError=function(e){return new te(T.code,T.desc+" Failed with error: "+e)},te.createTokenNullOrEmptyError=function(e){return new te(w.code,w.desc+" Raw Token Value: "+e)},te.createEndpointDiscoveryIncompleteError=function(e){return new te(I.code,I.desc+" Detail: "+e)},te.createInvalidAuthorityTypeError=function(e){return new te(A.code,A.desc+" Given Url: "+e)},te.createHashNotDeserializedError=function(e){return new te(S.code,S.desc+" Given Object: "+e)},te.createInvalidStateError=function(e,t){return new te(R.code,R.desc+" Invalid State: "+e+", Root Err: "+t)},te.createStateMismatchError=function(){return new te(_.code,_.desc)},te.createNonceMismatchError=function(){return new te(O.code,O.desc)},te.createAccountMismatchError=function(){return new te(b.code,b.desc)},te.createNoTokensFoundError=function(){return new te(N.code,N.desc)},te.createCacheParseError=function(e){return new te(k.code,k.desc+" Cache key: "+e)},te.createUserLoginRequiredError=function(){return new te(P.code,P.desc)},te.createMultipleMatchingTokensInCacheError=function(){return new te(U.code,U.desc+".")},te.createMultipleMatchingAccountsInCacheError=function(){return new te(L.code,L.desc)},te.createTokenRequestCannotBeMadeError=function(){return new te(M.code,M.desc)},te.createAppendEmptyScopeToSetError=function(e){return new te(D.code,D.desc+" Given Scope: "+e)},te.createRemoveEmptyScopeFromSetError=function(e){return new te(q.code,q.desc+" Given Scope: "+e)},te.createAppendScopeSetError=function(e){return new te(H.code,H.desc+" Detail Error: "+e)},te.createEmptyInputScopeSetError=function(e){return new te(K.code,K.desc+" Given ScopeSet: "+e)},te.createDeviceCodeCancelledError=function(){return new te(x.code,""+x.desc)},te.createDeviceCodeExpiredError=function(){return new te(F.code,""+F.desc)},te.createNoAccountInSilentRequestError=function(){return new te(G.code,""+G.desc)},te.createNullOrUndefinedCacheRecord=function(){return new te(j.code,j.desc)},te.createInvalidCacheEnvironmentError=function(){return new te(B.code,B.desc)},te.createNoAccountFoundError=function(){return new te(Y.code,Y.desc)},te.createCachePluginError=function(){return new te(z.code,""+z.desc)},te.createNoCryptoObjectError=function(e){return new te(V.code,""+V.desc+e)},te.createInvalidCacheTypeError=function(){return new te(W.code,""+W.desc)},te.createUnexpectedAccountTypeError=function(){return new te(J.code,""+J.desc)},te.createUnexpectedCredentialTypeError=function(){return new te(Q.code,""+Q.desc)},te.createInvalidAssertionError=function(){return new te(X.code,""+X.desc)},te.createInvalidCredentialError=function(){return new te(Z.code,""+Z.desc)},te.createRefreshRequiredError=function(){return new te($.code,$.desc)},te);function te(e,t){var r=h.call(this,e,t)||this;return r.name="ClientAuthError",Object.setPrototypeOf(r,te.prototype),r}var re,ne=(oe.decodeAuthToken=function(e){if(oe.isEmpty(e))throw ee.createTokenNullOrEmptyError(e);var t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(e);if(!t||t.length<4)throw ee.createTokenParsingError("Given token is malformed: "+JSON.stringify(e));return{header:t[1],JWSPayload:t[2],JWSSig:t[3]}},oe.isEmpty=function(e){return void 0===e||!e||0===e.length},oe.startsWith=function(e,t){return 0===e.indexOf(t)},oe.endsWith=function(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length},oe.queryStringToObject=function(e){function t(e){return decodeURIComponent(decodeURIComponent(e.replace(n," ")))}var r,n=/\+/g,o=/([^&=]+)=([^&]*)/g,i={};for(r=o.exec(e);r;)i[t(r[1])]=t(r[2]),r=o.exec(e);return i},oe.trimArrayEntries=function(e){return e.map(function(e){return e.trim()})},oe.removeEmptyStringsFromArray=function(e){return e.filter(function(e){return!oe.isEmpty(e)})},oe.jsonParseHelper=function(e){try{return JSON.parse(e)}catch(e){return null}},oe);function oe(){}(re=y.LogLevel||(y.LogLevel={}))[re.Error=0]="Error",re[re.Warning=1]="Warning",re[re.Info=2]="Info",re[re.Verbose=3]="Verbose";var ie=(se.prototype.logMessage=function(e,t){if(!(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)){var r=(new Date).toUTCString(),n=(ne.isEmpty(this.correlationId)?"["+r+"] : ":"["+r+"] : ["+this.correlationId+"]")+" : "+E+" : "+y.LogLevel[t.logLevel]+" - "+e;this.executeCallback(t.logLevel,n,t.containsPii)}},se.prototype.executeCallback=function(e,t,r){this.localCallback&&this.localCallback(e,t,r)},se.prototype.error=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Error,containsPii:!1,correlationId:t||""})},se.prototype.errorPii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Error,containsPii:!0,correlationId:t||""})},se.prototype.warning=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Warning,containsPii:!1,correlationId:t||""})},se.prototype.warningPii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Warning,containsPii:!0,correlationId:t||""})},se.prototype.info=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Info,containsPii:!1,correlationId:t||""})},se.prototype.infoPii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Info,containsPii:!0,correlationId:t||""})},se.prototype.verbose=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Verbose,containsPii:!1,correlationId:t||""})},se.prototype.verbosePii=function(e,t){this.logMessage(e,{logLevel:y.LogLevel.Verbose,containsPii:!0,correlationId:t||""})},se.prototype.isPiiLoggingEnabled=function(){return this.piiLoggingEnabled||!1},se);function se(e){this.level=y.LogLevel.Info,e&&(this.localCallback=e.loggerCallback,this.piiLoggingEnabled=e.piiLoggingEnabled,this.level=e.logLevel)}var ae,ce,ue,de,he,le,pe,fe,ye,me,ge={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",ADFS:"adfs",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined"};(ce=ae=ae||{}).CONTENT_TYPE="Content-Type",ce.X_CLIENT_CURR_TELEM="x-client-current-telemetry",ce.X_CLIENT_LAST_TELEM="x-client-last-telemetry",ce.RETRY_AFTER="Retry-After",ce.X_MS_LIB_CAPABILITY="x-ms-lib-capability",ce.X_MS_LIB_CAPABILITY_VALUE="retry-after, h429",(de=ue=ue||{}).ID_TOKEN="idtoken",de.CLIENT_INFO="client.info",de.ADAL_ID_TOKEN="adal.idtoken",de.ERROR="error",de.ERROR_DESC="error.description",(le=he=he||{}).COMMON="common",le.ORGANIZATIONS="organizations",le.CONSUMERS="consumers",(fe=pe=pe||{}).CLIENT_ID="client_id",fe.REDIRECT_URI="redirect_uri",fe.RESPONSE_TYPE="response_type",fe.RESPONSE_MODE="response_mode",fe.GRANT_TYPE="grant_type",fe.CLAIMS="claims",fe.SCOPE="scope",fe.ERROR="error",fe.ERROR_DESCRIPTION="error_description",fe.ACCESS_TOKEN="access_token",fe.ID_TOKEN="id_token",fe.REFRESH_TOKEN="refresh_token",fe.EXPIRES_IN="expires_in",fe.STATE="state",fe.NONCE="nonce",fe.PROMPT="prompt",fe.SESSION_STATE="session_state",fe.CLIENT_INFO="client_info",fe.CODE="code",fe.CODE_CHALLENGE="code_challenge",fe.CODE_CHALLENGE_METHOD="code_challenge_method",fe.CODE_VERIFIER="code_verifier",fe.CLIENT_REQUEST_ID="client-request-id",fe.X_CLIENT_SKU="x-client-SKU",fe.X_CLIENT_VER="x-client-VER",fe.X_CLIENT_OS="x-client-OS",fe.X_CLIENT_CPU="x-client-CPU",fe.POST_LOGOUT_URI="post_logout_redirect_uri",fe.DEVICE_CODE="device_code",fe.CLIENT_SECRET="client_secret",fe.CLIENT_ASSERTION="client_assertion",fe.CLIENT_ASSERTION_TYPE="client_assertion_type",fe.TOKEN_TYPE="token_type",fe.REQ_CNF="req_cnf",fe.OBO_ASSERTION="assertion",fe.REQUESTED_TOKEN_USE="requested_token_use",fe.ON_BEHALF_OF="on_behalf_of",fe.FOCI="foci",(me=ye=ye||{}).ACCESS_TOKEN="access_token",me.XMS_CC="xms_cc";var Ee,ve,Ce={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none"};(ve=Ee=Ee||{}).ACCOUNT="account",ve.SID="sid",ve.LOGIN_HINT="login_hint",ve.ID_TOKEN="id_token",ve.DOMAIN_HINT="domain_hint",ve.ORGANIZATIONS="organizations",ve.CONSUMERS="consumers",ve.ACCOUNT_ID="accountIdentifier",ve.HOMEACCOUNT_ID="homeAccountIdentifier";Ee.SID,Ee.LOGIN_HINT;var Te,we,Ie,Ae,Se,Re,_e,Oe,be,Ne,ke,Pe,Ue,Le,Me={PLAIN:"plain",S256:"S256"};(we=Te=Te||{}).QUERY="query",we.FRAGMENT="fragment",we.FORM_POST="form_post",(Ae=Ie=Ie||{}).IMPLICIT_GRANT="implicit",Ae.AUTHORIZATION_CODE_GRANT="authorization_code",Ae.CLIENT_CREDENTIALS_GRANT="client_credentials",Ae.RESOURCE_OWNER_PASSWORD_GRANT="password",Ae.REFRESH_TOKEN_GRANT="refresh_token",Ae.DEVICE_CODE_GRANT="device_code",Ae.JWT_BEARER="urn:ietf:params:oauth:grant-type:jwt-bearer",(Re=Se=Se||{}).MSSTS_ACCOUNT_TYPE="MSSTS",Re.ADFS_ACCOUNT_TYPE="ADFS",Re.MSAV1_ACCOUNT_TYPE="MSA",Re.GENERIC_ACCOUNT_TYPE="Generic",(Oe=_e=_e||{}).CACHE_KEY_SEPARATOR="-",Oe.CLIENT_INFO_SEPARATOR=".",(Ne=be=be||{}).ID_TOKEN="IdToken",Ne.ACCESS_TOKEN="AccessToken",Ne.REFRESH_TOKEN="RefreshToken",(Pe=ke=ke||{}).ACCOUNT="Account",Pe.CREDENTIAL="Credential",Pe.ID_TOKEN="IdToken",Pe.ACCESS_TOKEN="AccessToken",Pe.REFRESH_TOKEN="RefreshToken",Pe.APP_METADATA="AppMetadata",Pe.TEMPORARY="TempCache",Pe.TELEMETRY="Telemetry",Pe.UNDEFINED="Undefined",Pe.THROTTLING="Throttling",(Le=Ue=Ue||{})[Le.ADFS=1001]="ADFS",Le[Le.MSA=1002]="MSA",Le[Le.MSSTS=1003]="MSSTS",Le[Le.GENERIC=1004]="GENERIC",Le[Le.ACCESS_TOKEN=2001]="ACCESS_TOKEN",Le[Le.REFRESH_TOKEN=2002]="REFRESH_TOKEN",Le[Le.ID_TOKEN=2003]="ID_TOKEN",Le[Le.APP_METADATA=3001]="APP_METADATA",Le[Le.UNDEFINED=9999]="UNDEFINED";var De,qe="appmetadata",He={SCHEMA_VERSION:2,FAILURE_LIMIT:3,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:","};(De=y.AuthenticationScheme||(y.AuthenticationScheme={})).POP="pop",De.BEARER="Bearer";var Ke=60,xe=3600,Fe="throttling",Ge="invalid_grant",je="client_mismatch",Be=(Ye.prototype.generateAccountId=function(){return Ye.generateAccountIdForCacheKey(this.homeAccountId,this.environment)},Ye.prototype.generateCredentialId=function(){return Ye.generateCredentialIdForCacheKey(this.credentialType,this.clientId,this.realm,this.familyId)},Ye.prototype.generateTarget=function(){return Ye.generateTargetForCacheKey(this.target)},Ye.prototype.generateCredentialKey=function(){return Ye.generateCredentialCacheKey(this.homeAccountId,this.environment,this.credentialType,this.clientId,this.realm,this.target,this.familyId)},Ye.prototype.generateType=function(){switch(this.credentialType){case be.ID_TOKEN:return Ue.ID_TOKEN;case be.ACCESS_TOKEN:return Ue.ACCESS_TOKEN;case be.REFRESH_TOKEN:return Ue.REFRESH_TOKEN;default:throw ee.createUnexpectedCredentialTypeError()}},Ye.getCredentialType=function(e){return-1!==e.indexOf(be.ACCESS_TOKEN.toLowerCase())?be.ACCESS_TOKEN:-1!==e.indexOf(be.ID_TOKEN.toLowerCase())?be.ID_TOKEN:-1!==e.indexOf(be.REFRESH_TOKEN.toLowerCase())?be.REFRESH_TOKEN:ge.NOT_DEFINED},Ye.generateCredentialCacheKey=function(e,t,r,n,o,i,s){return[this.generateAccountIdForCacheKey(e,t),this.generateCredentialIdForCacheKey(r,n,o,s),this.generateTargetForCacheKey(i)].join(_e.CACHE_KEY_SEPARATOR).toLowerCase()},Ye.generateAccountIdForCacheKey=function(e,t){return[e,t].join(_e.CACHE_KEY_SEPARATOR).toLowerCase()},Ye.generateCredentialIdForCacheKey=function(e,t,r,n){return[e,e===be.REFRESH_TOKEN&&n||t,r||""].join(_e.CACHE_KEY_SEPARATOR).toLowerCase()},Ye.generateTargetForCacheKey=function(e){return(e||"").toLowerCase()},Ye);function Ye(){}var ze,Ve={code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},We={code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},Je={code:"claims_request_parsing_error",desc:"Could not parse the given claims request object."},Qe={code:"authority_uri_insecure",desc:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},Xe={code:"url_parse_error",desc:"URL could not be parsed into appropriate segments."},Ze={code:"empty_url_error",desc:"URL was empty or null."},$e={code:"empty_input_scopes_error",desc:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token."},et={code:"nonarray_input_scopes_error",desc:"Scopes cannot be passed as non-array."},tt={code:"clientid_input_scopes_error",desc:"Client ID can only be provided as a single scope."},rt={code:"invalid_prompt_value",desc:"Supported prompt values are 'login', 'select_account', 'consent' and 'none'.  Please see here for valid configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options"},nt={code:"invalid_claims",desc:"Given claims parameter must be a stringified JSON object."},ot={code:"token_request_empty",desc:"Token request was empty and not found in cache."},it={code:"logout_request_empty",desc:"The logout request was null or undefined."},st={code:"invalid_code_challenge_method",desc:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".'},at={code:"pkce_params_missing",desc:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request"},ct={code:"invalid_known_authorities",desc:"knownAuthorities and cloudDiscoveryMetadata cannot both be provided. Please provide cloudDiscoveryMetadata object for AAD, knownAuthorities otherwise."},ut={code:"invalid_cloud_discovery_metadata",desc:"Invalid cloudDiscoveryMetadata provided. Must be a JSON object containing tenant_discovery_endpoint and metadata fields"},dt={code:"untrusted_authority",desc:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter."},ht=(t(lt,ze=ee),lt.createRedirectUriEmptyError=function(){return new lt(Ve.code,Ve.desc)},lt.createPostLogoutRedirectUriEmptyError=function(){return new lt(We.code,We.desc)},lt.createClaimsRequestParsingError=function(e){return new lt(Je.code,Je.desc+" Given value: "+e)},lt.createInsecureAuthorityUriError=function(e){return new lt(Qe.code,Qe.desc+" Given URI: "+e)},lt.createUrlParseError=function(e){return new lt(Xe.code,Xe.desc+" Given Error: "+e)},lt.createUrlEmptyError=function(){return new lt(Ze.code,Ze.desc)},lt.createScopesNonArrayError=function(e){return new lt(et.code,et.desc+" Given Scopes: "+e)},lt.createEmptyScopesArrayError=function(e){return new lt($e.code,$e.desc+" Given Scopes: "+e)},lt.createClientIdSingleScopeError=function(e){return new lt(tt.code,tt.desc+" Given Scopes: "+e)},lt.createInvalidPromptError=function(e){return new lt(rt.code,rt.desc+" Given value: "+e)},lt.createInvalidClaimsRequestError=function(){return new lt(nt.code,nt.desc)},lt.createEmptyLogoutRequestError=function(){return new lt(it.code,it.desc)},lt.createEmptyTokenRequestError=function(){return new lt(ot.code,ot.desc)},lt.createInvalidCodeChallengeMethodError=function(){return new lt(st.code,st.desc)},lt.createInvalidCodeChallengeParamsError=function(){return new lt(at.code,at.desc)},lt.createKnownAuthoritiesCloudDiscoveryMetadataError=function(){return new lt(ct.code,ct.desc)},lt.createInvalidCloudDiscoveryMetadataError=function(){return new lt(ut.code,ut.desc)},lt.createUntrustedAuthorityError=function(){return new lt(dt.code,dt.desc)},lt);function lt(e,t){var r=ze.call(this,e,t)||this;return r.name="ClientConfigurationError",Object.setPrototypeOf(r,lt.prototype),r}var pt,ft,yt=(mt.fromString=function(e){return new mt((e=e||"").split(" "))},mt.prototype.validateInputScopes=function(e){if(!e||e.length<1)throw ht.createEmptyScopesArrayError(e)},mt.prototype.containsScope=function(e){var t=new mt(this.printScopesLowerCase().split(" "));return!ne.isEmpty(e)&&t.scopes.has(e.toLowerCase())},mt.prototype.containsScopeSet=function(e){var t=this;return!(!e||e.scopes.size<=0)&&this.scopes.size>=e.scopes.size&&e.asArray().every(function(e){return t.containsScope(e)})},mt.prototype.containsOnlyDefaultScopes=function(){var e=0;return this.containsScope(ge.OPENID_SCOPE)&&(e+=1),this.containsScope(ge.PROFILE_SCOPE)&&(e+=1),this.containsScope(ge.OFFLINE_ACCESS_SCOPE)&&(e+=1),this.scopes.size===e},mt.prototype.appendScope=function(e){ne.isEmpty(e)||this.scopes.add(e.trim())},mt.prototype.appendScopes=function(e){var t=this;try{e.forEach(function(e){return t.appendScope(e)})}catch(e){throw ee.createAppendScopeSetError(e)}},mt.prototype.removeScope=function(e){if(ne.isEmpty(e))throw ee.createRemoveEmptyScopeFromSetError(e);this.scopes.delete(e.trim())},mt.prototype.removeDefaultScopes=function(){this.scopes.delete(ge.OFFLINE_ACCESS_SCOPE),this.scopes.delete(ge.OPENID_SCOPE),this.scopes.delete(ge.PROFILE_SCOPE)},mt.prototype.unionScopeSets=function(e){if(!e)throw ee.createEmptyInputScopeSetError(e);var t=new Set;return e.scopes.forEach(function(e){return t.add(e.toLowerCase())}),this.scopes.forEach(function(e){return t.add(e.toLowerCase())}),t},mt.prototype.intersectingScopeSets=function(e){if(!e)throw ee.createEmptyInputScopeSetError(e);var t=this.unionScopeSets(e);e.containsOnlyDefaultScopes()||e.removeDefaultScopes();var r=e.getScopeCount(),n=this.getScopeCount();return t.size<n+r},mt.prototype.getScopeCount=function(){return this.scopes.size},mt.prototype.asArray=function(){var t=[];return this.scopes.forEach(function(e){return t.push(e)}),t},mt.prototype.printScopes=function(){return this.scopes?this.asArray().join(" "):""},mt.prototype.printScopesLowerCase=function(){return this.printScopes().toLowerCase()},mt);function mt(e){var t=this,r=e?ne.trimArrayEntries(i(e)):[],n=r?ne.removeEmptyStringsFromArray(r):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(function(e){return t.scopes.add(e)})}(ft=pt=pt||{})[ft.Default=0]="Default",ft[ft.Adfs=1]="Adfs";var gt=(Object.defineProperty(Et.prototype,"urlString",{get:function(){return this._urlString},enumerable:!0,configurable:!0}),Et.canonicalizeUri=function(e){return(e=e&&e.toLowerCase())&&!ne.endsWith(e,"/")&&(e+="/"),e},Et.prototype.validateAsUri=function(){var e;try{e=this.getUrlComponents()}catch(e){throw ht.createUrlParseError(e)}if(!e.HostNameAndPort||!e.PathSegments||e.PathSegments.length<1)throw ht.createUrlParseError("Given url string: "+this.urlString);if(!e.Protocol||"https:"!==e.Protocol.toLowerCase())throw ht.createInsecureAuthorityUriError(this.urlString)},Et.prototype.urlRemoveQueryStringParameter=function(e){var t=new RegExp("(\\&"+e+"=)[^&]+");return this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+&"),this._urlString=this.urlString.replace(t,""),t=new RegExp("("+e+"=)[^&]+"),this._urlString=this.urlString.replace(t,""),this.urlString},Et.removeHashFromUrl=function(e){return Et.canonicalizeUri(e.split("#")[0])},Et.prototype.replaceTenantPath=function(e){var t=this.getUrlComponents(),r=t.PathSegments;return!e||0===r.length||r[0]!==he.COMMON&&r[0]!==he.ORGANIZATIONS||(r[0]=e),Et.constructAuthorityUriFromObject(t)},Et.prototype.getHash=function(){return Et.parseHash(this.urlString)},Et.prototype.getUrlComponents=function(){var e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw ht.createUrlParseError("Given url string: "+this.urlString);var r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},n=r.AbsolutePath.split("/");return n=n.filter(function(e){return e&&0<e.length}),r.PathSegments=n,!ne.isEmpty(r.QueryString)&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r},Et.getDomainFromUrl=function(e){var t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw ht.createUrlParseError("Given url string: "+e);return r[2]},Et.parseHash=function(e){var t=e.indexOf("#"),r=e.indexOf("#/");return-1<r?e.substring(r+2):-1<t?e.substring(t+1):""},Et.constructAuthorityUriFromObject=function(e){return new Et(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))},Et.getDeserializedHash=function(e){if(ne.isEmpty(e))return{};var t=Et.parseHash(e),r=ne.queryStringToObject(ne.isEmpty(t)?e:t);if(!r)throw ee.createHashNotDeserializedError(JSON.stringify(r));return r},Et.hashContainsKnownProperties=function(e){if(ne.isEmpty(e))return!1;var t=Et.getDeserializedHash(e);return!!(t.code||t.error_description||t.error||t.state)},Et);function Et(e){if(this._urlString=e,ne.isEmpty(this._urlString))throw ht.createUrlEmptyError();ne.isEmpty(this.getHash())&&(this._urlString=Et.canonicalizeUri(e))}var vt=(Ct.setTrustedAuthoritiesFromConfig=function(e,t){if(!this.getTrustedHostList().length){if(0<e.length&&!ne.isEmpty(t))throw ht.createKnownAuthoritiesCloudDiscoveryMetadataError();this.createCloudDiscoveryMetadataFromKnownAuthorities(e);try{if(t){var r=JSON.parse(t);this.saveCloudDiscoveryMetadata(r.metadata)}}catch(e){throw ht.createInvalidCloudDiscoveryMetadataError()}}},Ct.setTrustedAuthoritiesFromNetwork=function(i,s){return m(this,void 0,void 0,function(){var t,r,n,o;return g(this,function(e){switch(e.label){case 0:t=""+ge.AAD_INSTANCE_DISCOVERY_ENDPT+i.urlString+"oauth2/v2.0/authorize",e.label=1;case 1:return e.trys.push([1,3,,4]),[4,s.sendGetRequestAsync(t)];case 2:return r=e.sent(),n=r.body.metadata,this.saveCloudDiscoveryMetadata(n),[3,4];case 3:return e.sent(),[2];case 4:return o=i.getUrlComponents().HostNameAndPort,0<this.getTrustedHostList().length&&!this.IsInTrustedHostList(o)&&this.createCloudDiscoveryMetadataFromKnownAuthorities([o]),[2]}})})},Ct.saveCloudDiscoveryMetadata=function(e){e.forEach(function(t){t.aliases.forEach(function(e){Ct.TrustedHostList[e.toLowerCase()]=t})})},Ct.createCloudDiscoveryMetadataFromKnownAuthorities=function(e){var r=this;e.forEach(function(e){var t=gt.getDomainFromUrl(e).toLowerCase();r.TrustedHostList[t]={preferred_cache:t,preferred_network:t,aliases:[t]}})},Ct.getTrustedHostList=function(){return Object.keys(this.TrustedHostList)},Ct.getCloudDiscoveryMetadata=function(e){return this.TrustedHostList[e.toLowerCase()]||null},Ct.IsInTrustedHostList=function(e){return-1<Object.keys(this.TrustedHostList).indexOf(e.toLowerCase())},Ct.TrustedHostList={},Ct);function Ct(){}var Tt=(Object.defineProperty(wt.prototype,"authorityType",{get:function(){var e=this.canonicalAuthorityUrlComponents.PathSegments;return e.length&&e[0].toLowerCase()===ge.ADFS?pt.Adfs:pt.Default},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"canonicalAuthority",{get:function(){return this._canonicalAuthority.urlString},set:function(e){this._canonicalAuthority=new gt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"canonicalAuthorityUrlComponents",{get:function(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"tenant",{get:function(){return this.canonicalAuthorityUrlComponents.PathSegments[0]},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"authorizationEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.authorization_endpoint);throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"tokenEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.token_endpoint);throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"deviceCodeEndpoint",{get:function(){if(this.discoveryComplete())return this.tenantDiscoveryResponse.token_endpoint.replace("/token","/devicecode");throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"endSessionEndpoint",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.end_session_endpoint);throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),Object.defineProperty(wt.prototype,"selfSignedJwtAudience",{get:function(){if(this.discoveryComplete())return this.replaceTenant(this.tenantDiscoveryResponse.issuer);throw ee.createEndpointDiscoveryIncompleteError("Discovery incomplete.")},enumerable:!0,configurable:!0}),wt.prototype.replaceTenant=function(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)},Object.defineProperty(wt.prototype,"defaultOpenIdConfigurationEndpoint",{get:function(){return this.authorityType===pt.Adfs?this.canonicalAuthority+".well-known/openid-configuration":this.canonicalAuthority+"v2.0/.well-known/openid-configuration"},enumerable:!0,configurable:!0}),wt.prototype.discoveryComplete=function(){return!!this.tenantDiscoveryResponse},wt.prototype.discoverEndpoints=function(t){return m(this,void 0,void 0,function(){return g(this,function(e){return[2,this.networkInterface.sendGetRequestAsync(t)]})})},Object.defineProperty(wt.prototype,"aadInstanceDiscoveryEndpointUrl",{get:function(){return""+ge.AAD_INSTANCE_DISCOVERY_ENDPT+this.canonicalAuthority+"oauth2/v2.0/authorize"},enumerable:!0,configurable:!0}),wt.prototype.validateAndSetPreferredNetwork=function(){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return t=this.canonicalAuthorityUrlComponents.HostNameAndPort,0!==vt.getTrustedHostList().length?[3,2]:[4,vt.setTrustedAuthoritiesFromNetwork(this._canonicalAuthority,this.networkInterface)];case 1:e.sent(),e.label=2;case 2:if(!vt.IsInTrustedHostList(t))throw ht.createUntrustedAuthorityError();return r=vt.getCloudDiscoveryMetadata(t).preferred_network,t!==r&&(this.canonicalAuthority=this.canonicalAuthority.replace(t,r)),[2]}})})},wt.prototype.resolveEndpointsAsync=function(){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return[4,this.validateAndSetPreferredNetwork()];case 1:return e.sent(),t=this.defaultOpenIdConfigurationEndpoint,[4,this.discoverEndpoints(t)];case 2:return r=e.sent(),this.tenantDiscoveryResponse=r.body,[2]}})})},wt.generateEnvironmentFromAuthority=function(e){var t=e.canonicalAuthorityUrlComponents.HostNameAndPort;return vt.getCloudDiscoveryMetadata(t)?vt.getCloudDiscoveryMetadata(t).preferred_cache:""},wt);function wt(e,t){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t}function It(e,t){if(ne.isEmpty(e))throw ee.createClientInfoEmptyError(e);try{var r=t.base64Decode(e);return JSON.parse(r)}catch(e){throw ee.createClientInfoDecodingError(e)}}var At=(St.prototype.generateAccountId=function(){return[this.homeAccountId,this.environment].join(_e.CACHE_KEY_SEPARATOR).toLowerCase()},St.prototype.generateAccountKey=function(){return St.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username})},St.prototype.generateType=function(){switch(this.authorityType){case Se.ADFS_ACCOUNT_TYPE:return Ue.ADFS;case Se.MSAV1_ACCOUNT_TYPE:return Ue.MSA;case Se.MSSTS_ACCOUNT_TYPE:return Ue.MSSTS;case Se.GENERIC_ACCOUNT_TYPE:return Ue.GENERIC;default:throw ee.createUnexpectedAccountTypeError()}},St.prototype.getAccountInfo=function(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,name:this.name}},St.generateAccountCacheKey=function(e){return[e.homeAccountId,e.environment||"",e.tenantId||""].join(_e.CACHE_KEY_SEPARATOR).toLowerCase()},St.createAccount=function(e,t,r,n,o){var i=new St;i.authorityType=Se.MSSTS_ACCOUNT_TYPE;var s=It(i.clientInfo=e,n);i.homeAccountId=""+s.uid+_e.CLIENT_INFO_SEPARATOR+s.utid;var a=Tt.generateEnvironmentFromAuthority(t);if(ne.isEmpty(a))throw ee.createInvalidCacheEnvironmentError();if(i.environment=a,i.realm=r.claims.tid||"",i.oboAssertion=o,r){var c=ne.isEmpty(r.claims.oid)?r.claims.sid:r.claims.oid;i.localAccountId=c,i.username=r.claims.preferred_username||(r.claims.emails?r.claims.emails[0]:""),i.name=r.claims.name}return i},St.createADFSAccount=function(e,t,r){var n=new St;n.authorityType=Se.ADFS_ACCOUNT_TYPE,n.homeAccountId=t.claims.sub,n.realm="",n.oboAssertion=r;var o=Tt.generateEnvironmentFromAuthority(e);if(ne.isEmpty(o))throw ee.createInvalidCacheEnvironmentError();return n.environment=o,n.username=t.claims.upn,n},St.isAccountEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType")},St);function St(){}var Rt=(_t.prototype.generateAppMetadataKey=function(){return _t.generateAppMetadataCacheKey(this.environment,this.clientId)},_t.generateAppMetadataCacheKey=function(e,t){return[qe,e,t].join(_e.CACHE_KEY_SEPARATOR).toLowerCase()},_t.createAppMetadataEntity=function(e,t,r){var n=new _t;return n.clientId=e,n.environment=t,r&&(n.familyId=r),n},_t.isAppMetadataEntity=function(e,t){return 0===e.indexOf(qe)&&t.hasOwnProperty("clientId")&&t.hasOwnProperty("environment")},_t);function _t(){}var Ot=(bt.prototype.getAllAccounts=function(){var t=this.getAccountsFilteredBy(),e=Object.keys(t).map(function(e){return t[e]});return e.length<1?[]:e.map(function(e){var t=new At;return(t=bt.toObject(t,e)).getAccountInfo()})},bt.prototype.saveCacheRecord=function(e){if(!e)throw ee.createNullOrUndefinedCacheRecord();e.account&&this.saveAccount(e.account),e.idToken&&this.saveCredential(e.idToken),e.accessToken&&this.saveAccessToken(e.accessToken),e.refreshToken&&this.saveCredential(e.refreshToken)},bt.prototype.saveAccount=function(e){var t=e.generateAccountKey();this.setItem(t,e,ke.ACCOUNT)},bt.prototype.saveCredential=function(e){var t=e.generateCredentialKey();this.setItem(t,e,ke.CREDENTIAL)},bt.prototype.saveAccessToken=function(e){var t=this,r=this.getCredentialsFilteredBy({clientId:e.clientId,credentialType:be.ACCESS_TOKEN,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm}),n=yt.fromString(e.target),o=Object.keys(r.accessTokens).map(function(e){return r.accessTokens[e]});o&&o.forEach(function(e){yt.fromString(e.target).intersectingScopeSets(n)&&t.removeCredential(e)}),this.saveCredential(e)},bt.prototype.getAccount=function(e){if(Be.getCredentialType(e)!==ge.NOT_DEFINED||this.isAppMetadata(e))return null;var t;try{t=this.getItem(e,ke.ACCOUNT)}catch(e){return null}return!t||ne.isEmpty(t.authorityType)?null:t},bt.prototype.getCredential=function(e){return this.getItem(e,ke.CREDENTIAL)},bt.prototype.getAppMetadata=function(e){return this.getItem(e,ke.APP_METADATA)},bt.prototype.getAccountsFilteredBy=function(e){return this.getAccountsFilteredByInternal(e?e.homeAccountId:"",e?e.environment:"",e?e.realm:"")},bt.prototype.getAccountsFilteredByInternal=function(r,n,o){var i=this,e=this.getKeys(),s={};return e.forEach(function(e){var t=i.getAccount(e);if(!t)return null;(ne.isEmpty(r)||i.matchHomeAccountId(t,r))&&(ne.isEmpty(n)||i.matchEnvironment(t,n))&&(ne.isEmpty(o)||i.matchRealm(t,o))&&(s[e]=t)}),s},bt.prototype.getCredentialsFilteredBy=function(e){return this.getCredentialsFilteredByInternal(e.homeAccountId,e.environment,e.credentialType,e.clientId,e.familyId,e.realm,e.target,e.oboAssertion)},bt.prototype.getCredentialsFilteredByInternal=function(n,o,i,s,a,c,u,d){var h=this,e=this.getKeys(),l={idTokens:{},accessTokens:{},refreshTokens:{}};return e.forEach(function(e){var t,r=Be.getCredentialType(e);if(r!==ge.NOT_DEFINED){try{t=h.getItem(e,ke.CREDENTIAL)}catch(e){return}if((ne.isEmpty(d)||h.matchOboAssertion(t,d))&&(ne.isEmpty(n)||h.matchHomeAccountId(t,n))&&(ne.isEmpty(o)||h.matchEnvironment(t,o))&&(ne.isEmpty(c)||h.matchRealm(t,c))&&(ne.isEmpty(i)||h.matchCredentialType(t,i))&&(ne.isEmpty(s)||h.matchClientId(t,s))&&(ne.isEmpty(a)||h.matchFamilyId(t,a))&&(ne.isEmpty(u)||h.matchTarget(t,u)))switch(r){case be.ID_TOKEN:l.idTokens[e]=t;break;case be.ACCESS_TOKEN:l.accessTokens[e]=t;break;case be.REFRESH_TOKEN:l.refreshTokens[e]=t}}}),l},bt.prototype.removeAllAccounts=function(){var t=this;return this.getKeys().forEach(function(e){t.getAccount(e)&&t.removeAccount(e)}),!0},bt.prototype.removeAccount=function(e){var t=this.getAccount(e);if(!t)throw ee.createNoAccountFoundError();return this.removeAccountContext(t)&&this.removeItem(e,ke.ACCOUNT)},bt.prototype.removeAccountContext=function(e){var r=this,t=this.getKeys(),n=e.generateAccountId();return t.forEach(function(e){if(Be.getCredentialType(e)!==ge.NOT_DEFINED){var t=r.getItem(e,ke.CREDENTIAL);t&&n===t.generateAccountId()&&r.removeCredential(t)}}),!0},bt.prototype.removeCredential=function(e){var t=e.generateCredentialKey();return this.removeItem(t,ke.CREDENTIAL)},bt.prototype.removeAppMetadata=function(){var t=this;return this.getKeys().forEach(function(e){t.isAppMetadata(e)&&t.removeItem(e,ke.APP_METADATA)}),!0},bt.prototype.readCacheRecord=function(e,t,r,n){return{account:this.readAccountFromCache(e),idToken:this.readIdTokenFromCache(t,e),accessToken:this.readAccessTokenFromCache(t,e,r),refreshToken:this.readRefreshTokenFromCache(t,e,!1),appMetadata:this.readAppMetadataFromCache(n,t)}},bt.prototype.readAccountFromCache=function(e){var t=At.generateAccountCacheKey(e);return this.getAccount(t)},bt.prototype.readIdTokenFromCache=function(e,t){var r=Be.generateCredentialCacheKey(t.homeAccountId,t.environment,be.ID_TOKEN,e,t.tenantId);return this.getCredential(r)},bt.prototype.readAccessTokenFromCache=function(e,t,r){var n={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:be.ACCESS_TOKEN,clientId:e,realm:t.tenantId,target:r.printScopesLowerCase()},o=this.getCredentialsFilteredBy(n),i=Object.keys(o.accessTokens).map(function(e){return o.accessTokens[e]}),s=i.length;if(s<1)return null;if(1<s)throw ee.createMultipleMatchingTokensInCacheError();return i[0]},bt.prototype.readRefreshTokenFromCache=function(e,t,r){var n=r?"1":null,o={homeAccountId:t.homeAccountId,environment:t.environment,credentialType:be.REFRESH_TOKEN,clientId:e,familyId:n},i=this.getCredentialsFilteredBy(o),s=Object.keys(i.refreshTokens).map(function(e){return i.refreshTokens[e]});return s.length<1?null:s[0]},bt.prototype.readAppMetadataFromCache=function(e,t){var r=Rt.generateAppMetadataCacheKey(e,t);return this.getAppMetadata(r)},bt.prototype.isAppMetadataFOCI=function(e,t){var r=this.readAppMetadataFromCache(e,t);return r&&"1"===r.familyId},bt.prototype.matchHomeAccountId=function(e,t){return e.homeAccountId&&t===e.homeAccountId},bt.prototype.matchOboAssertion=function(e,t){return e.oboAssertion&&t===e.oboAssertion},bt.prototype.matchEnvironment=function(e,t){var r=vt.getCloudDiscoveryMetadata(t);return!!(r&&-1<r.aliases.indexOf(e.environment))},bt.prototype.matchCredentialType=function(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()},bt.prototype.matchClientId=function(e,t){return e.clientId&&t===e.clientId},bt.prototype.matchFamilyId=function(e,t){return e.familyId&&t===e.familyId},bt.prototype.matchRealm=function(e,t){return e.realm&&t===e.realm},bt.prototype.matchTarget=function(e,t){if(e.credentialType!==be.ACCESS_TOKEN||ne.isEmpty(e.target))return!1;var r=yt.fromString(e.target),n=yt.fromString(t);return n.containsOnlyDefaultScopes()||n.removeDefaultScopes(),r.containsScopeSet(n)},bt.prototype.isAppMetadata=function(e){return-1!==e.indexOf(qe)},bt.toObject=function(e,t){for(var r in t)e[r]=t[r];return e},bt);function bt(){}var Nt,kt=(t(Pt,Nt=Ot),Pt.prototype.setItem=function(){throw a.createUnexpectedError("Storage interface - setItem() has not been implemented for the cacheStorage interface.")},Pt.prototype.getItem=function(){throw a.createUnexpectedError("Storage interface - getItem() has not been implemented for the cacheStorage interface.")},Pt.prototype.removeItem=function(){throw a.createUnexpectedError("Storage interface - removeItem() has not been implemented for the cacheStorage interface.")},Pt.prototype.containsKey=function(){throw a.createUnexpectedError("Storage interface - containsKey() has not been implemented for the cacheStorage interface.")},Pt.prototype.getKeys=function(){throw a.createUnexpectedError("Storage interface - getKeys() has not been implemented for the cacheStorage interface.")},Pt.prototype.clear=function(){throw a.createUnexpectedError("Storage interface - clear() has not been implemented for the cacheStorage interface.")},Pt);function Pt(){return null!==Nt&&Nt.apply(this,arguments)||this}var Ut={clientId:"",authority:null,knownAuthorities:[],cloudDiscoveryMetadata:"",clientCapabilities:[]},Lt={tokenRenewalOffsetSeconds:300},Mt={loggerCallback:function(){},piiLoggingEnabled:!1,logLevel:y.LogLevel.Info},Dt={sendGetRequestAsync:function(){return m(this,void 0,void 0,function(){return g(this,function(e){throw"Network interface - sendGetRequestAsync() has not been implemented",a.createUnexpectedError("Network interface - sendGetRequestAsync() has not been implemented")})})},sendPostRequestAsync:function(){return m(this,void 0,void 0,function(){return g(this,function(e){throw"Network interface - sendPostRequestAsync() has not been implemented",a.createUnexpectedError("Network interface - sendPostRequestAsync() has not been implemented")})})}},qt={createNewGuid:function(){throw a.createUnexpectedError("Crypto interface - createNewGuid() has not been implemented")},base64Decode:function(){throw a.createUnexpectedError("Crypto interface - base64Decode() has not been implemented")},base64Encode:function(){throw a.createUnexpectedError("Crypto interface - base64Encode() has not been implemented")},generatePkceCodes:function(){return m(this,void 0,void 0,function(){return g(this,function(e){throw"Crypto interface - generatePkceCodes() has not been implemented",a.createUnexpectedError("Crypto interface - generatePkceCodes() has not been implemented")})})},getPublicKeyThumbprint:function(){return m(this,void 0,void 0,function(){return g(this,function(e){throw"Crypto interface - getPublicKeyThumbprint() has not been implemented",a.createUnexpectedError("Crypto interface - getPublicKeyThumbprint() has not been implemented")})})},signJwt:function(){return m(this,void 0,void 0,function(){return g(this,function(e){throw"Crypto interface - signJwt() has not been implemented",a.createUnexpectedError("Crypto interface - signJwt() has not been implemented")})})}},Ht={sku:ge.SKU,version:l,cpu:"",os:""},Kt={clientSecret:"",clientAssertion:null};var xt,Ft=(t(Gt,xt=a),Gt);function Gt(e,t,r){var n=xt.call(this,e,t)||this;return n.name="ServerError",n.subError=r,Object.setPrototypeOf(n,Gt.prototype),n}var jt=(Bt.generateThrottlingStorageKey=function(e){return Fe+"."+JSON.stringify(e)},Bt.preProcess=function(e,t){var r=Bt.generateThrottlingStorageKey(t),n=e.getItem(r,ke.THROTTLING);if(n){if(n.throttleTime<Date.now())return void e.removeItem(r,ke.THROTTLING);throw new Ft(n.errorCodes.join(" "),n.errorMessage,n.subError)}},Bt.postProcess=function(e,t,r){if(Bt.checkResponseStatus(r)||Bt.checkResponseForRetryAfter(r)){var n={throttleTime:Bt.calculateThrottleTime(parseInt(r.headers[ae.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setItem(Bt.generateThrottlingStorageKey(t),n,ke.THROTTLING)}},Bt.checkResponseStatus=function(e){return 429==e.status||500<=e.status&&e.status<600},Bt.checkResponseForRetryAfter=function(e){return!!e.headers&&e.headers.hasOwnProperty(ae.RETRY_AFTER)&&(e.status<200||300<=e.status)},Bt.calculateThrottleTime=function(e){e<=0&&(e=null);var t=Date.now()/1e3;return Math.floor(1e3*Math.min(t+(e||Ke),t+xe))},Bt.removeThrottle=function(e,t,r,n,o){var i={clientId:t,authority:r,scopes:n,homeAccountIdentifier:o},s=this.generateThrottlingStorageKey(i);return e.removeItem(s,ke.THROTTLING)},Bt);function Bt(){}var Yt=(zt.prototype.sendPostRequest=function(r,n,o){return m(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return jt.preProcess(this.cacheManager,r),[4,this.networkClient.sendPostRequestAsync(n,o)];case 1:return t=e.sent(),jt.postProcess(this.cacheManager,r,t),[2,t]}})})},zt);function zt(e,t){this.networkClient=e,this.cacheManager=t}var Vt=(Wt.prototype.createDefaultTokenRequestHeaders=function(){var e=this.createDefaultLibraryHeaders();return e[ae.CONTENT_TYPE]=ge.URL_FORM_CONTENT_TYPE,e[ae.X_MS_LIB_CAPABILITY]=ae.X_MS_LIB_CAPABILITY_VALUE,this.serverTelemetryManager&&(e[ae.X_CLIENT_CURR_TELEM]=this.serverTelemetryManager.generateCurrentRequestHeaderValue(),e[ae.X_CLIENT_LAST_TELEM]=this.serverTelemetryManager.generateLastRequestHeaderValue()),e},Wt.prototype.createDefaultLibraryHeaders=function(){var e={};return e[pe.X_CLIENT_SKU]=this.config.libraryInfo.sku,e[pe.X_CLIENT_VER]=this.config.libraryInfo.version,e[pe.X_CLIENT_OS]=this.config.libraryInfo.os,e[pe.X_CLIENT_CPU]=this.config.libraryInfo.cpu,e},Wt.prototype.executePostToTokenEndpoint=function(r,n,o,i){return m(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return[4,this.networkManager.sendPostRequest(i,r,{body:n,headers:o})];case 1:return t=e.sent(),this.config.serverTelemetryManager&&t.status<500&&429!==t.status&&this.config.serverTelemetryManager.clearTelemetryCache(),[2,t]}})})},Wt);function Wt(e){this.config=function(e){var t=e.authOptions,r=e.systemOptions,n=e.loggerOptions,o=e.storageInterface,i=e.networkInterface,s=e.cryptoInterface,a=e.clientCredentials,c=e.libraryInfo,u=e.serverTelemetryManager;return{authOptions:d(d({},Ut),t),systemOptions:d(d({},Lt),r),loggerOptions:d(d({},Mt),n),storageInterface:o||new kt,networkInterface:i||Dt,cryptoInterface:s||qt,clientCredentials:a||Kt,libraryInfo:d(d({},Ht),c),serverTelemetryManager:u||null}}(e),this.logger=new ie(this.config.loggerOptions),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Yt(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,vt.setTrustedAuthoritiesFromConfig(this.config.authOptions.knownAuthorities,this.config.authOptions.cloudDiscoveryMetadata),this.authority=this.config.authOptions.authority}var Jt=(Qt.validateRedirectUri=function(e){if(ne.isEmpty(e))throw ht.createRedirectUriEmptyError()},Qt.validatePrompt=function(e){if([Ce.LOGIN,Ce.SELECT_ACCOUNT,Ce.CONSENT,Ce.NONE].indexOf(e)<0)throw ht.createInvalidPromptError(e)},Qt.validateClaims=function(e){try{JSON.parse(e)}catch(e){throw ht.createInvalidClaimsRequestError()}},Qt.validateCodeChallengeParams=function(e,t){if(ne.isEmpty(e)||ne.isEmpty(t))throw ht.createInvalidCodeChallengeParamsError();this.validateCodeChallengeMethod(t)},Qt.validateCodeChallengeMethod=function(e){if([Me.PLAIN,Me.S256].indexOf(e)<0)throw ht.createInvalidCodeChallengeMethodError()},Qt.sanitizeEQParams=function(r,e){return r?(e.forEach(function(e,t){r[t]&&delete r[t]}),r):null},Qt);function Qt(){}var Xt=(Zt.prototype.addResponseTypeCode=function(){this.parameters.set(pe.RESPONSE_TYPE,encodeURIComponent(ge.CODE_RESPONSE_TYPE))},Zt.prototype.addResponseMode=function(e){this.parameters.set(pe.RESPONSE_MODE,encodeURIComponent(e||Te.QUERY))},Zt.prototype.addScopes=function(e,t){void 0===t&&(t=!0);var r=t?i(e||[],[ge.OPENID_SCOPE,ge.PROFILE_SCOPE]):e||[],n=new yt(r);this.parameters.set(pe.SCOPE,encodeURIComponent(n.printScopes()))},Zt.prototype.addClientId=function(e){this.parameters.set(pe.CLIENT_ID,encodeURIComponent(e))},Zt.prototype.addRedirectUri=function(e){Jt.validateRedirectUri(e),this.parameters.set(pe.REDIRECT_URI,encodeURIComponent(e))},Zt.prototype.addDomainHint=function(e){this.parameters.set(Ee.DOMAIN_HINT,encodeURIComponent(e))},Zt.prototype.addLoginHint=function(e){this.parameters.set(Ee.LOGIN_HINT,encodeURIComponent(e))},Zt.prototype.addSid=function(e){this.parameters.set(Ee.SID,encodeURIComponent(e))},Zt.prototype.addClaims=function(e,t){var r=this.addClientCapabilitiesToClaims(e,t);Jt.validateClaims(r),this.parameters.set(pe.CLAIMS,encodeURIComponent(r))},Zt.prototype.addCorrelationId=function(e){this.parameters.set(pe.CLIENT_REQUEST_ID,encodeURIComponent(e))},Zt.prototype.addLibraryInfo=function(e){this.parameters.set(pe.X_CLIENT_SKU,e.sku),this.parameters.set(pe.X_CLIENT_VER,e.version),this.parameters.set(pe.X_CLIENT_OS,e.os),this.parameters.set(pe.X_CLIENT_CPU,e.cpu)},Zt.prototype.addPrompt=function(e){Jt.validatePrompt(e),this.parameters.set(""+pe.PROMPT,encodeURIComponent(e))},Zt.prototype.addState=function(e){ne.isEmpty(e)||this.parameters.set(pe.STATE,encodeURIComponent(e))},Zt.prototype.addNonce=function(e){this.parameters.set(pe.NONCE,encodeURIComponent(e))},Zt.prototype.addCodeChallengeParams=function(e,t){if(Jt.validateCodeChallengeParams(e,t),!e||!t)throw ht.createInvalidCodeChallengeParamsError();this.parameters.set(pe.CODE_CHALLENGE,encodeURIComponent(e)),this.parameters.set(pe.CODE_CHALLENGE_METHOD,encodeURIComponent(t))},Zt.prototype.addAuthorizationCode=function(e){this.parameters.set(pe.CODE,encodeURIComponent(e))},Zt.prototype.addDeviceCode=function(e){this.parameters.set(pe.DEVICE_CODE,encodeURIComponent(e))},Zt.prototype.addRefreshToken=function(e){this.parameters.set(pe.REFRESH_TOKEN,encodeURIComponent(e))},Zt.prototype.addCodeVerifier=function(e){this.parameters.set(pe.CODE_VERIFIER,encodeURIComponent(e))},Zt.prototype.addClientSecret=function(e){this.parameters.set(pe.CLIENT_SECRET,encodeURIComponent(e))},Zt.prototype.addClientAssertion=function(e){this.parameters.set(pe.CLIENT_ASSERTION,encodeURIComponent(e))},Zt.prototype.addClientAssertionType=function(e){this.parameters.set(pe.CLIENT_ASSERTION_TYPE,encodeURIComponent(e))},Zt.prototype.addOboAssertion=function(e){this.parameters.set(pe.OBO_ASSERTION,encodeURIComponent(e))},Zt.prototype.addRequestTokenUse=function(e){this.parameters.set(pe.REQUESTED_TOKEN_USE,encodeURIComponent(e))},Zt.prototype.addGrantType=function(e){this.parameters.set(pe.GRANT_TYPE,encodeURIComponent(e))},Zt.prototype.addClientInfo=function(){this.parameters.set("client_info","1")},Zt.prototype.addExtraQueryParameters=function(t){var r=this;Jt.sanitizeEQParams(t,this.parameters),Object.keys(t).forEach(function(e){r.parameters.set(e,t[e])})},Zt.prototype.addClientCapabilitiesToClaims=function(e,t){var r;if(ne.isEmpty(e))r={};else try{r=JSON.parse(e)}catch(e){throw ht.createInvalidClaimsRequestError()}return t&&0<t.length&&(r.hasOwnProperty(ye.ACCESS_TOKEN)||(r[ye.ACCESS_TOKEN]={}),r[ye.ACCESS_TOKEN][ye.XMS_CC]={values:t}),JSON.stringify(r)},Zt.prototype.addPopToken=function(e){ne.isEmpty(e)||(this.parameters.set(pe.TOKEN_TYPE,y.AuthenticationScheme.POP),this.parameters.set(pe.REQ_CNF,encodeURIComponent(e)))},Zt.prototype.createQueryString=function(){var r=new Array;return this.parameters.forEach(function(e,t){r.push(t+"="+e)}),r.join("&")},Zt);function Zt(){this.parameters=new Map}var $t=(er.extractTokenClaims=function(e,t){var r=ne.decodeAuthToken(e);if(!r)return null;try{var n=r.JWSPayload,o=t.base64Decode(n);return JSON.parse(o)}catch(e){throw ee.createTokenParsingError(e)}},er);function er(e,t){if(ne.isEmpty(e))throw ee.createTokenNullOrEmptyError(e);this.rawToken=e,this.claims=er.extractTokenClaims(e,t)}var tr=(rr.nowSeconds=function(){return Math.round((new Date).getTime()/1e3)},rr.isTokenExpired=function(e,t){return(Number(e)||0)<rr.nowSeconds()+t},rr);function rr(){}var nr,or=(t(ir,nr=Be),ir.createIdTokenEntity=function(e,t,r,n,o,i){var s=new ir;return s.credentialType=be.ID_TOKEN,s.homeAccountId=e,s.environment=t,s.clientId=n,s.secret=r,s.realm=o,s.oboAssertion=i,s},ir.isIdTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===be.ID_TOKEN},ir);function ir(){return null!==nr&&nr.apply(this,arguments)||this}var sr,ar=(t(cr,sr=Be),cr.createAccessTokenEntity=function(e,t,r,n,o,i,s,a,c,u){var d=new cr;d.homeAccountId=e,d.credentialType=be.ACCESS_TOKEN,d.secret=r;var h=tr.nowSeconds();return d.cachedAt=h.toString(),d.expiresOn=s.toString(),d.extendedExpiresOn=a.toString(),d.environment=t,d.clientId=n,d.realm=o,d.target=i,d.oboAssertion=u,d.tokenType=ne.isEmpty(c)?y.AuthenticationScheme.BEARER:c,d},cr.isAccessTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.hasOwnProperty("target")&&e.credentialType===be.ACCESS_TOKEN},cr);function cr(){return null!==sr&&sr.apply(this,arguments)||this}var ur,dr=(t(hr,ur=Be),hr.createRefreshTokenEntity=function(e,t,r,n,o,i){var s=new hr;return s.clientId=n,s.credentialType=be.REFRESH_TOKEN,s.environment=t,s.homeAccountId=e,s.secret=r,s.oboAssertion=i,o&&(s.familyId=o),s},hr.isRefreshTokenEntity=function(e){return e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("credentialType")&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("secret")&&e.credentialType===be.REFRESH_TOKEN},hr);function hr(){return null!==ur&&ur.apply(this,arguments)||this}var lr,pr=["interaction_required","consent_required","login_required"],fr=["message_only","additional_action","basic_action","user_password_expired","consent_required"],yr=(t(mr,lr=Ft),mr.isInteractionRequiredError=function(e,t,r){var n=!ne.isEmpty(e)&&-1<pr.indexOf(e),o=!ne.isEmpty(r)&&-1<fr.indexOf(r),i=!ne.isEmpty(t)&&pr.some(function(e){return-1<t.indexOf(e)});return n||i||o},mr);function mr(e,t,r){var n=lr.call(this,e,t,r)||this;return n.name="InteractionRequiredAuthError",Object.setPrototypeOf(n,mr.prototype),n}var gr,Er,vr=function(e,t,r,n,o){this.account=e,this.idToken=t,this.accessToken=r,this.refreshToken=n,this.appMetadata=o},Cr=(Tr.setRequestState=function(e,t,r){var n=Tr.generateLibraryState(e,r);return ne.isEmpty(t)?n:""+n+ge.RESOURCE_DELIM+t},Tr.generateLibraryState=function(e,t){if(!e)throw ee.createNoCryptoObjectError("generateLibraryState");var r={id:e.createNewGuid(),ts:tr.nowSeconds()};t&&(r.meta=t);var n=JSON.stringify(r);return e.base64Encode(n)},Tr.parseRequestState=function(e,t){if(!e)throw ee.createNoCryptoObjectError("parseRequestState");if(ne.isEmpty(t))throw ee.createInvalidStateError(t,"Null, undefined or empty state");try{var r=decodeURIComponent(t).split(ge.RESOURCE_DELIM),n=r[0],o=1<r.length?r.slice(1).join(ge.RESOURCE_DELIM):"",i=e.base64Decode(n),s=JSON.parse(i);return{userRequestState:ne.isEmpty(o)?"":o,libraryState:s}}catch(e){throw ee.createInvalidStateError(t,e)}},Tr);function Tr(){}(Er=gr=gr||{}).SW="sw",Er.UHW="uhw";var wr=(Ir.prototype.generateCnf=function(n,o){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return[4,this.cryptoUtils.getPublicKeyThumbprint(n,o)];case 1:return t=e.sent(),r={kid:t,xms_ksl:gr.SW},[2,this.cryptoUtils.base64Encode(JSON.stringify(r))]}})})},Ir.prototype.signPopToken=function(o,i,s){return m(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return t=$t.extractTokenClaims(o,this.cryptoUtils),r=new gt(s),n=r.getUrlComponents(),[4,this.cryptoUtils.signJwt({at:o,ts:""+tr.nowSeconds(),m:i.toUpperCase(),u:n.HostNameAndPort||"",nonce:this.cryptoUtils.createNewGuid(),p:n.AbsolutePath,q:[[],n.QueryString]},t.cnf.kid)];case 1:return[2,e.sent()]}})})},Ir);function Ir(e){this.cryptoUtils=e}var Ar=(Sr.prototype.validateServerAuthorizationCodeResponse=function(e,t,r){if(decodeURIComponent(e.state)!==decodeURIComponent(t))throw ee.createStateMismatchError();if(e.error||e.error_description||e.suberror){if(yr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new yr(e.error,e.error_description,e.suberror);throw new Ft(e.error,e.error_description,e.suberror)}e.client_info&&It(e.client_info,r)},Sr.prototype.validateTokenResponse=function(e){if(e.error||e.error_description||e.suberror){if(yr.isInteractionRequiredError(e.error,e.error_description,e.suberror))throw new yr(e.error,e.error_description,e.suberror);var t=e.error_codes+" - ["+e.timestamp+"]: "+e.error_description+" - Correlation ID: "+e.correlation_id+" - Trace ID: "+e.trace_id;throw new Ft(e.error,t)}},Sr.prototype.handleServerTokenResponse=function(o,i,s,a,c,u,d,h){return m(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:if(o.client_info?(this.clientInfo=It(o.client_info,this.cryptoObj),ne.isEmpty(this.clientInfo.uid)||ne.isEmpty(this.clientInfo.utid)||(this.homeAccountIdentifier=this.clientInfo.uid+"."+this.clientInfo.utid)):this.homeAccountIdentifier="",t=null,!ne.isEmpty(o.id_token)&&(t=new $t(o.id_token,this.cryptoObj),!ne.isEmpty(c)&&t.claims.nonce!==c))throw ee.createNonceMismatchError();return r=null,ne.isEmpty(u)||(r=Cr.parseRequestState(this.cryptoObj,u)),n=this.generateCacheRecord(o,t,i,r&&r.libraryState,d,h),this.cacheStorage.saveCacheRecord(n),[4,Sr.generateAuthenticationResult(this.cryptoObj,n,t,!1,r,s,a)];case 1:return[2,e.sent()]}})})},Sr.prototype.generateCacheRecord=function(e,t,r,n,o,i){var s=Tt.generateEnvironmentFromAuthority(r);if(ne.isEmpty(s))throw ee.createInvalidCacheEnvironmentError();var a=null,c=null;ne.isEmpty(e.id_token)||(a=or.createIdTokenEntity(this.homeAccountIdentifier,s,e.id_token,this.clientId,t.claims.tid||"",i),c=this.generateAccountEntity(e,t,r,i));var u=null;if(!ne.isEmpty(e.access_token)){var d=e.scope?yt.fromString(e.scope):new yt(o||[]),h=tr.nowSeconds(),l=(n?n.ts:h)+e.expires_in,p=l+e.ext_expires_in;u=ar.createAccessTokenEntity(this.homeAccountIdentifier,s,e.access_token,this.clientId,t?t.claims.tid||"":r.tenant,d.printScopes(),l,p,e.token_type,i)}var f=null;ne.isEmpty(e.refresh_token)||(f=dr.createRefreshTokenEntity(this.homeAccountIdentifier,s,e.refresh_token,this.clientId,e.foci,i));var y=null;return ne.isEmpty(e.foci)||(y=Rt.createAppMetadataEntity(this.clientId,s,e.foci)),new vr(c,a,u,f,y)},Sr.prototype.generateAccountEntity=function(e,t,r,n){if(r.authorityType===pt.Adfs)return At.createADFSAccount(r,t,n);if(ne.isEmpty(e.client_info))throw ee.createClientInfoEmptyError(e.client_info);return At.createAccount(e.client_info,r,t,this.cryptoObj,n)},Sr.generateAuthenticationResult=function(c,u,d,h,l,p,f){return m(this,void 0,void 0,function(){var t,r,n,o,i,s,a;return g(this,function(e){switch(e.label){case 0:return t="",r=[],i=o=n=null,u.accessToken?u.accessToken.tokenType!==y.AuthenticationScheme.POP?[3,2]:[4,new wr(c).signPopToken(u.accessToken.secret,p,f)]:[3,4];case 1:return t=e.sent(),[3,3];case 2:t=u.accessToken.secret,e.label=3;case 3:r=yt.fromString(u.accessToken.target).asArray(),n=new Date(1e3*Number(u.accessToken.expiresOn)),o=new Date(1e3*Number(u.accessToken.extendedExpiresOn)),e.label=4;case 4:return u.appMetadata&&(i=u.appMetadata.familyId||null),s=d?d.claims.oid||d.claims.sub:"",a=d?d.claims.tid:"",[2,{uniqueId:s,tenantId:a,scopes:r,account:u.account?u.account.getAccountInfo():null,idToken:d?d.rawToken:"",idTokenClaims:d?d.claims:null,accessToken:t,fromCache:h,expiresOn:n,extExpiresOn:o,familyId:i,tokenType:u.accessToken?u.accessToken.tokenType:"",state:l?l.userRequestState:""}]}})})},Sr);function Sr(e,t,r,n){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=n}var Rr,_r=(t(Or,Rr=Vt),Or.prototype.getAuthCodeUrl=function(r){return m(this,void 0,void 0,function(){var t;return g(this,function(e){return t=this.createAuthCodeUrlQueryString(r),[2,this.authority.authorizationEndpoint+"?"+t]})})},Or.prototype.acquireToken=function(n,o,i){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:if(this.logger.info("in acquireToken call"),!n||ne.isEmpty(n.code))throw ee.createTokenRequestCannotBeMadeError();return[4,this.executeTokenRequest(this.authority,n)];case 1:return t=e.sent(),(r=new Ar(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[4,r.handleServerTokenResponse(t.body,this.authority,n.resourceRequestMethod,n.resourceRequestUri,o,i)];case 2:return[2,e.sent()]}})})},Or.prototype.handleFragmentResponse=function(e,t){var r=new Ar(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger),n=new gt(e),o=gt.getDeserializedHash(n.getHash());return r.validateServerAuthorizationCodeResponse(o,t,this.cryptoUtils),o.code},Or.prototype.getLogoutUri=function(e){if(!e)throw ht.createEmptyLogoutRequestError();e.account?this.cacheManager.removeAccount(At.generateAccountCacheKey(e.account)):this.cacheManager.clear();var t=e.postLogoutRedirectUri?"?"+pe.POST_LOGOUT_URI+"="+encodeURIComponent(e.postLogoutRedirectUri):"",r=e.correlationId?"&"+pe.CLIENT_REQUEST_ID+"="+encodeURIComponent(e.correlationId):"";return this.authority.endSessionEndpoint+t+r},Or.prototype.executeTokenRequest=function(o,i){return m(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return t={clientId:this.config.authOptions.clientId,authority:o.canonicalAuthority,scopes:i.scopes},[4,this.createTokenRequestBody(i)];case 1:return r=e.sent(),n=this.createDefaultTokenRequestHeaders(),[2,this.executePostToTokenEndpoint(o.tokenEndpoint,r,n,t)]}})})},Or.prototype.createTokenRequestBody=function(i){return m(this,void 0,void 0,function(){var t,r,n,o;return g(this,function(e){switch(e.label){case 0:return(t=new Xt).addClientId(this.config.authOptions.clientId),t.addRedirectUri(i.redirectUri),t.addScopes(i.scopes),t.addAuthorizationCode(i.code),i.codeVerifier&&t.addCodeVerifier(i.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(r=this.config.clientCredentials.clientAssertion,t.addClientAssertion(r.assertion),t.addClientAssertionType(r.assertionType)),t.addGrantType(Ie.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),i.authenticationScheme!==y.AuthenticationScheme.POP?[3,2]:[4,new wr(this.cryptoUtils).generateCnf(i.resourceRequestMethod,i.resourceRequestUri)];case 1:n=e.sent(),t.addPopToken(n),e.label=2;case 2:return o=i.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(o),(!ne.isEmpty(i.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(i.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}})})},Or.prototype.createAuthCodeUrlQueryString=function(e){var t=new Xt;t.addClientId(this.config.authOptions.clientId);var r=i(e.scopes||[],e.extraScopesToConsent||[]);t.addScopes(r),t.addRedirectUri(e.redirectUri);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return t.addCorrelationId(n),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),t.addClientInfo(),e.codeChallenge&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.sid?t.addSid(e.sid):e.loginHint?t.addLoginHint(e.loginHint):e.account&&e.account.username&&t.addLoginHint(e.account.username),e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(!ne.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()},Or);function Or(e){return Rr.call(this,e)||this}var br;t(Nr,br=Vt),Nr.prototype.acquireToken=function(o){return m(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return[4,this.getDeviceCode(o)];case 1:return t=e.sent(),o.deviceCodeCallback(t),[4,this.acquireTokenWithDeviceCode(o,t)];case 2:return r=e.sent(),(n=new Ar(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(r),[4,n.handleServerTokenResponse(r,this.authority,o.resourceRequestMethod,o.resourceRequestUri)];case 3:return[2,e.sent()]}})})},Nr.prototype.getDeviceCode=function(o){return m(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){return t=this.createQueryString(o),r=this.createDefaultLibraryHeaders(),n={clientId:this.config.authOptions.clientId,authority:o.authority,scopes:o.scopes},[2,this.executePostRequestToDeviceCodeEndpoint(this.authority.deviceCodeEndpoint,t,r,n)]})})},Nr.prototype.executePostRequestToDeviceCodeEndpoint=function(c,u,d,h){return m(this,void 0,void 0,function(){var t,r,n,o,i,s,a;return g(this,function(e){switch(e.label){case 0:return[4,this.networkManager.sendPostRequest(h,c,{body:u,headers:d})];case 1:return t=e.sent().body,r=t.user_code,n=t.device_code,o=t.verification_uri,i=t.expires_in,s=t.interval,a=t.message,[2,{userCode:r,deviceCode:n,verificationUri:o,expiresIn:i,interval:s,message:a}]}})})},Nr.prototype.createQueryString=function(e){var t=new Xt;return t.addScopes(e.scopes),t.addClientId(this.config.authOptions.clientId),(!ne.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()},Nr.prototype.acquireTokenWithDeviceCode=function(d,n){return m(this,void 0,void 0,function(){var a,c,u,t,r=this;return g(this,function(e){return a=this.createTokenRequestBody(d,n),c=this.createDefaultTokenRequestHeaders(),u=tr.nowSeconds()+n.expiresIn,t=1e3*n.interval,[2,new Promise(function(o,i){var s=setInterval(function(){return m(r,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,5,,6]),d.cancel?(this.logger.error("Token request cancelled by setting DeviceCodeRequest.cancel = true"),clearInterval(s),i(ee.createDeviceCodeCancelledError()),[3,4]):[3,1];case 1:return tr.nowSeconds()>u?(this.logger.error("Device code expired. Expiration time of device code was "+u),clearInterval(s),i(ee.createDeviceCodeExpiredError()),[3,4]):[3,2];case 2:return t={clientId:this.config.authOptions.clientId,authority:d.authority,scopes:d.scopes},[4,this.executePostToTokenEndpoint(this.authority.tokenEndpoint,a,c,t)];case 3:(r=e.sent()).body&&r.body.error==ge.AUTHORIZATION_PENDING?this.logger.info(r.body.error_description):(clearInterval(s),o(r.body)),e.label=4;case 4:return[3,6];case 5:return n=e.sent(),clearInterval(s),i(n),[3,6];case 6:return[2]}})})},t)})]})})},Nr.prototype.createTokenRequestBody=function(e,t){var r=new Xt;r.addScopes(e.scopes),r.addClientId(this.config.authOptions.clientId),r.addGrantType(Ie.DEVICE_CODE_GRANT),r.addDeviceCode(t.deviceCode);var n=e.correlationId||this.config.cryptoInterface.createNewGuid();return r.addCorrelationId(n),r.addClientInfo(),(!ne.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),r.createQueryString()};function Nr(e){return br.call(this,e)||this}var kr,Pr=(t(Ur,kr=Vt),Ur.prototype.acquireToken=function(n){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:return[4,this.executeTokenRequest(n,this.authority)];case 1:return t=e.sent(),(r=new Ar(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(t.body),[4,r.handleServerTokenResponse(t.body,this.authority,n.resourceRequestMethod,n.resourceRequestUri)];case 2:return[2,e.sent()]}})})},Ur.prototype.acquireTokenByRefreshToken=function(n){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){if(!n)throw ht.createEmptyTokenRequestError();if(!n.account)throw ee.createNoAccountInSilentRequestError();if(this.cacheManager.isAppMetadataFOCI(n.account.environment,this.config.authOptions.clientId))try{return[2,this.acquireTokenWithCachedRefreshToken(n,!0)]}catch(e){if(t=e instanceof ee&&e.errorCode===N.code,r=e instanceof Ft&&e.errorCode===Ge&&e.subError===je,t||r)return[2,this.acquireTokenWithCachedRefreshToken(n,!1)];throw e}return[2,this.acquireTokenWithCachedRefreshToken(n,!1)]})})},Ur.prototype.acquireTokenWithCachedRefreshToken=function(n,o){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){if(!(t=this.cacheManager.readRefreshTokenFromCache(this.config.authOptions.clientId,n.account,o)))throw ee.createNoTokensFoundError();return r=d(d({},n),{refreshToken:t.secret}),[2,this.acquireToken(r)]})})},Ur.prototype.executeTokenRequest=function(o,i){return m(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:return[4,this.createTokenRequestBody(o)];case 1:return t=e.sent(),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:i.canonicalAuthority,scopes:o.scopes},[2,this.executePostToTokenEndpoint(i.tokenEndpoint,t,r,n)]}})})},Ur.prototype.createTokenRequestBody=function(a){return m(this,void 0,void 0,function(){var t,r,n,o,i,s;return g(this,function(e){switch(e.label){case 0:return(t=new Xt).addClientId(this.config.authOptions.clientId),t.addScopes(a.scopes),t.addGrantType(Ie.REFRESH_TOKEN_GRANT),t.addClientInfo(),r=a.correlationId||this.config.cryptoInterface.createNewGuid(),t.addCorrelationId(r),t.addRefreshToken(a.refreshToken),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion&&(n=this.config.clientCredentials.clientAssertion,t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)),a.authenticationScheme!==y.AuthenticationScheme.POP?[3,2]:(o=new wr(this.cryptoUtils),s=(i=t).addPopToken,[4,o.generateCnf(a.resourceRequestMethod,a.resourceRequestUri)]);case 1:s.apply(i,[e.sent()]),e.label=2;case 2:return(!ne.isEmpty(a.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(a.claims,this.config.authOptions.clientCapabilities),[2,t.createQueryString()]}})})},Ur);function Ur(e){return kr.call(this,e)||this}var Lr;t(Mr,Lr=Vt),Mr.prototype.acquireToken=function(r){return m(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return this.scopeSet=new yt(r.scopes||[]),r.skipCache?[4,this.executeTokenRequest(r,this.authority)]:[3,2];case 1:return[2,e.sent()];case 2:return[4,this.getCachedAuthenticationResult()];case 3:return null==(t=e.sent())?[3,4]:[2,t];case 4:return[4,this.executeTokenRequest(r,this.authority)];case 5:return[2,e.sent()]}})})},Mr.prototype.getCachedAuthenticationResult=function(){return m(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return!(t=this.readAccessTokenFromCache())||tr.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:[4,Ar.generateAuthenticationResult(this.cryptoUtils,{account:null,accessToken:t,idToken:null,refreshToken:null,appMetadata:null},null,!0)];case 1:return[2,e.sent()]}})})},Mr.prototype.readAccessTokenFromCache=function(){var e={homeAccountId:"",environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:be.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase()},t=this.cacheManager.getCredentialsFilteredBy(e),r=Object.keys(t.accessTokens).map(function(e){return t.accessTokens[e]});if(r.length<1)return null;if(1<r.length)throw ee.createMultipleMatchingTokensInCacheError();return r[0]},Mr.prototype.executeTokenRequest=function(s,a){return m(this,void 0,void 0,function(){var t,r,n,o,i;return g(this,function(e){switch(e.label){case 0:return t=this.createTokenRequestBody(s),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:s.authority,scopes:s.scopes},[4,this.executePostToTokenEndpoint(a.tokenEndpoint,t,r,n)];case 1:return o=e.sent(),(i=new Ar(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,s.resourceRequestMethod,s.resourceRequestUri,null,null,s.scopes)];case 2:return[2,e.sent()]}})})},Mr.prototype.createTokenRequestBody=function(e){var t=new Xt;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes,!1),t.addGrantType(Ie.CLIENT_CREDENTIALS_GRANT);var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return(!ne.isEmpty(e.claims)||this.config.authOptions.clientCapabilities&&0<this.config.authOptions.clientCapabilities.length)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),t.createQueryString()};function Mr(e){return Lr.call(this,e)||this}var Dr;t(qr,Dr=Vt),qr.prototype.acquireToken=function(r){return m(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return this.scopeSet=new yt(r.scopes||[]),r.skipCache?[4,this.executeTokenRequest(r,this.authority)]:[3,2];case 1:return[2,e.sent()];case 2:return null==(t=this.getCachedAuthenticationResult(r))?[3,3]:[2,t];case 3:return[4,this.executeTokenRequest(r,this.authority)];case 4:return[2,e.sent()]}})})},qr.prototype.getCachedAuthenticationResult=function(s){return m(this,void 0,void 0,function(){var t,r,n,o,i;return g(this,function(e){switch(e.label){case 0:return!(t=this.readAccessTokenFromCache(s))||tr.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds)?[2,null]:(r=this.readIdTokenFromCache(s),o=n=null,r&&(n=new $t(r.secret,this.config.cryptoInterface),i=At.generateAccountCacheKey({homeAccountId:r.homeAccountId,environment:r.environment,tenantId:r.realm,username:null}),o=this.cacheManager.getAccount(i)),[4,Ar.generateAuthenticationResult(this.cryptoUtils,{account:o,accessToken:t,idToken:r,refreshToken:null,appMetadata:null},n,!0)]);case 1:return[2,e.sent()]}})})},qr.prototype.readAccessTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:be.ACCESS_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,target:this.scopeSet.printScopesLowerCase(),oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.accessTokens).map(function(e){return r.accessTokens[e]}),o=n.length;if(o<1)return null;if(1<o)throw ee.createMultipleMatchingTokensInCacheError();return n[0]},qr.prototype.readIdTokenFromCache=function(e){var t={environment:this.authority.canonicalAuthorityUrlComponents.HostNameAndPort,credentialType:be.ID_TOKEN,clientId:this.config.authOptions.clientId,realm:this.authority.tenant,oboAssertion:e.oboAssertion},r=this.cacheManager.getCredentialsFilteredBy(t),n=Object.keys(r.idTokens).map(function(e){return r.idTokens[e]});return n.length<1?null:n[0]},qr.prototype.executeTokenRequest=function(s,a){return m(this,void 0,void 0,function(){var t,r,n,o,i;return g(this,function(e){switch(e.label){case 0:return t=this.createTokenRequestBody(s),r=this.createDefaultTokenRequestHeaders(),n={clientId:this.config.authOptions.clientId,authority:s.authority,scopes:s.scopes},[4,this.executePostToTokenEndpoint(a.tokenEndpoint,t,r,n)];case 1:return o=e.sent(),(i=new Ar(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger)).validateTokenResponse(o.body),[4,i.handleServerTokenResponse(o.body,this.authority,s.resourceRequestMethod,s.resourceRequestUri,null,null,s.scopes,s.oboAssertion)];case 2:return[2,e.sent()]}})})},qr.prototype.createTokenRequestBody=function(e){var t=new Xt;t.addClientId(this.config.authOptions.clientId),t.addScopes(e.scopes),t.addGrantType(Ie.JWT_BEARER),t.addClientInfo();var r=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(r),t.addRequestTokenUse(pe.ON_BEHALF_OF),t.addOboAssertion(e.oboAssertion),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){var n=this.config.clientCredentials.clientAssertion;t.addClientAssertion(n.assertion),t.addClientAssertionType(n.assertionType)}return t.createQueryString()};function qr(e){return Dr.call(this,e)||this}var Hr,Kr=(t(xr,Hr=Vt),xr.prototype.acquireToken=function(r){return m(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.acquireCachedToken(r)];case 1:return[2,e.sent()];case 2:if((t=e.sent())instanceof ee&&t.errorCode===$.code)return[2,new Pr(this.config).acquireTokenByRefreshToken(r)];throw t;case 3:return[2]}})})},xr.prototype.acquireCachedToken=function(o){return m(this,void 0,void 0,function(){var t,r,n;return g(this,function(e){switch(e.label){case 0:if(!o)throw ht.createEmptyTokenRequestError();if(!o.account)throw ee.createNoAccountInSilentRequestError();if(t=new yt(o.scopes||[]),r=o.authority||Tt.generateEnvironmentFromAuthority(this.authority),n=this.cacheManager.readCacheRecord(o.account,this.config.authOptions.clientId,t,r),!this.isRefreshRequired(o,n.accessToken))return[3,1];throw ee.createRefreshRequiredError();case 1:return this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[4,this.generateResultFromCacheRecord(n,o.resourceRequestMethod,o.resourceRequestUri)];case 2:return[2,e.sent()]}})})},xr.prototype.generateResultFromCacheRecord=function(r,n,o){return m(this,void 0,void 0,function(){var t;return g(this,function(e){switch(e.label){case 0:return t=new $t(r.idToken.secret,this.config.cryptoInterface),[4,Ar.generateAuthenticationResult(this.cryptoUtils,r,t,!0,null,n,o)];case 1:return[2,e.sent()]}})})},xr.prototype.isRefreshRequired=function(e,t){return!(!e.forceRefresh&&!e.claims&&t&&!tr.isTokenExpired(t.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))},xr);function xr(e){return Hr.call(this,e)||this}var Fr=(Gr.createDiscoveredInstance=function(n,o){return m(this,void 0,void 0,function(){var t,r;return g(this,function(e){switch(e.label){case 0:if((t=Gr.createInstance(n,o)).discoveryComplete())return[2,t];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,t.resolveEndpointsAsync()];case 2:return e.sent(),[2,t];case 3:throw r=e.sent(),ee.createEndpointDiscoveryIncompleteError(r);case 4:return[2]}})})},Gr.createInstance=function(e,t){if(ne.isEmpty(e))throw ht.createUrlEmptyError();return new Tt(e,t)},Gr);function Gr(){}var jr=(Br.prototype.generateCurrentRequestHeaderValue=function(){var e=this.forceRefresh?1:0,t=""+this.apiId+He.VALUE_SEPARATOR+e;return[He.SCHEMA_VERSION,t,""].join(He.CATEGORY_SEPARATOR)},Br.prototype.generateLastRequestHeaderValue=function(){var e=this.getLastRequests(),t=e.failedRequests.join(He.VALUE_SEPARATOR),r=e.errors.join(He.VALUE_SEPARATOR),n=e.errorCount;return[He.SCHEMA_VERSION,e.cacheHits,t,r,n].join(He.CATEGORY_SEPARATOR)},Br.prototype.cacheFailedRequest=function(e){var t=this.getLastRequests();t.failedRequests.push(this.apiId,this.correlationId),t.errors.push(ne.isEmpty(e.suberror)?e.errorCode:e.suberror),t.errorCount+=1,t.errors.length>He.FAILURE_LIMIT&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),this.cacheManager.setItem(this.telemetryCacheKey,t,ke.TELEMETRY)},Br.prototype.incrementCacheHits=function(){var e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setItem(this.telemetryCacheKey,e,ke.TELEMETRY),e.cacheHits},Br.prototype.getLastRequests=function(){return this.cacheManager.getItem(this.telemetryCacheKey,ke.TELEMETRY)||{failedRequests:[],errors:[],errorCount:0,cacheHits:0}},Br.prototype.clearTelemetryCache=function(){this.cacheManager.removeItem(this.telemetryCacheKey)},Br);function Br(e,t){this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.forceRefresh=e.forceRefresh||!1,this.telemetryCacheKey=He.CACHE_KEY+_e.CACHE_KEY_SEPARATOR+e.clientId}var Yr,zr,Vr,Wr,Jr,Qr,Xr,Zr,$r={CACHE_LOCATION_LOCAL:"localStorage",CACHE_LOCATION_SESSION:"sessionStorage",INTERACTION_STATUS_KEY:"interaction.status",INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POLL_INTERVAL_MS:50,MSAL_SKU:"msal.js.browser"};(zr=Yr=Yr||{}).GET="GET",zr.POST="POST",(Wr=Vr=Vr||{}).AUTHORITY="authority",Wr.ACQUIRE_TOKEN_ACCOUNT="acquireToken.account",Wr.SESSION_STATE="session.state",Wr.REQUEST_STATE="request.state",Wr.NONCE_IDTOKEN="nonce.id_token",Wr.ORIGIN_URI="request.origin",Wr.RENEW_STATUS="token.renew.status",Wr.URL_HASH="urlHash",Wr.REQUEST_PARAMS="request.params",Wr.SCOPES="scopes",(Qr=Jr=Jr||{})[Qr.acquireTokenRedirect=861]="acquireTokenRedirect",Qr[Qr.acquireTokenPopup=862]="acquireTokenPopup",Qr[Qr.ssoSilent=863]="ssoSilent",Qr[Qr.acquireTokenSilent_authCode=864]="acquireTokenSilent_authCode",Qr[Qr.handleRedirectPromise=865]="handleRedirectPromise",Qr[Qr.acquireTokenSilent_silentFlow=61]="acquireTokenSilent_silentFlow",(Zr=Xr=Xr||{}).REDIRECT="redirect",Zr.POPUP="popup",Zr.SILENT="silent";var en={scopes:[ge.OPENID_SCOPE,ge.PROFILE_SCOPE]},tn="jwk",rn=(nn.decimalToHex=function(e){for(var t=e.toString(16);t.length<2;)t="0"+t;return t},nn);function nn(){}var on=(sn.prototype.generateGuid=function(){try{var e=new Uint8Array(16);return this.cryptoObj.getRandomValues(e),e[6]|=64,e[6]&=79,e[8]|=128,e[8]&=191,rn.decimalToHex(e[0])+rn.decimalToHex(e[1])+rn.decimalToHex(e[2])+rn.decimalToHex(e[3])+"-"+rn.decimalToHex(e[4])+rn.decimalToHex(e[5])+"-"+rn.decimalToHex(e[6])+rn.decimalToHex(e[7])+"-"+rn.decimalToHex(e[8])+rn.decimalToHex(e[9])+"-"+rn.decimalToHex(e[10])+rn.decimalToHex(e[11])+rn.decimalToHex(e[12])+rn.decimalToHex(e[13])+rn.decimalToHex(e[14])+rn.decimalToHex(e[15])}catch(e){for(var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",r="0123456789abcdef",n=0,o="",i=0;i<36;i++)"-"!==t[i]&&"4"!==t[i]&&(n=16*Math.random()|0),"x"===t[i]?o+=r[n]:"y"===t[i]?(n&=3,o+=r[n|=8]):o+=t[i];return o}},sn.isGuid=function(e){return/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(e)},sn);function sn(e){this.cryptoObj=e}var an=(cn.stringToUtf8Arr=function(e){for(var t,r=0,n=e.length,o=0;o<n;o++)r+=(t=e.charCodeAt(o))<128?1:t<2048?2:t<65536?3:t<2097152?4:t<67108864?5:6;for(var i=new Uint8Array(r),s=0,a=0;s<r;a++)(t=e.charCodeAt(a))<128?i[s++]=t:(t<2048?i[s++]=192+(t>>>6):(t<65536?i[s++]=224+(t>>>12):(t<2097152?i[s++]=240+(t>>>18):(t<67108864?i[s++]=248+(t>>>24):(i[s++]=252+(t>>>30),i[s++]=128+(t>>>24&63)),i[s++]=128+(t>>>18&63)),i[s++]=128+(t>>>12&63)),i[s++]=128+(t>>>6&63)),i[s++]=128+(63&t));return i},cn.stringToArrayBuffer=function(e){for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n<e.length;n++)r[n]=e.charCodeAt(n);return t},cn.utf8ArrToString=function(e){for(var t="",r=void 0,n=e.length,o=0;o<n;o++)r=e[o],t+=String.fromCharCode(251<r&&r<254&&o+5<n?1073741824*(r-252)+(e[++o]-128<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:247<r&&r<252&&o+4<n?(r-248<<24)+(e[++o]-128<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:239<r&&r<248&&o+3<n?(r-240<<18)+(e[++o]-128<<12)+(e[++o]-128<<6)+e[++o]-128:223<r&&r<240&&o+2<n?(r-224<<12)+(e[++o]-128<<6)+e[++o]-128:191<r&&r<224&&o+1<n?(r-192<<6)+e[++o]-128:r);return t},cn);function cn(){}var un=(dn.prototype.urlEncode=function(e){return encodeURIComponent(this.encode(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))},dn.prototype.urlEncodeArr=function(e){return this.base64EncArr(e).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")},dn.prototype.encode=function(e){var t=an.stringToUtf8Arr(e);return this.base64EncArr(t)},dn.prototype.base64EncArr=function(e){for(var t=(3-e.length%3)%3,r="",n=void 0,o=e.length,i=0,s=0;s<o;s++)n=s%3,i|=e[s]<<(16>>>n&24),2!==n&&e.length-s!=1||(r+=String.fromCharCode(this.uint6ToB64(i>>>18&63),this.uint6ToB64(i>>>12&63),this.uint6ToB64(i>>>6&63),this.uint6ToB64(63&i)),i=0);return 0==t?r:r.substring(0,r.length-t)+(1==t?"=":"==")},dn.prototype.uint6ToB64=function(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65},dn);function dn(){}var hn=(ln.prototype.decode=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw new Error("Invalid base64 string")}var r=this.base64DecToArr(t);return an.utf8ArrToString(r)},ln.prototype.base64DecToArr=function(e,t){for(var r=e.replace(/[^A-Za-z0-9\+\/]/g,""),n=r.length,o=t?Math.ceil((3*n+1>>>2)/t)*t:3*n+1>>>2,i=new Uint8Array(o),s=void 0,a=void 0,c=0,u=0,d=0;d<n;d++)if(a=3&d,c|=this.b64ToUint6(r.charCodeAt(d))<<18-6*a,3===a||n-d==1){for(s=0;s<3&&u<o;s++,u++)i[u]=c>>>(16>>>s&24)&255;c=0}return i},ln.prototype.b64ToUint6=function(e){return 64<e&&e<91?e-65:96<e&&e<123?e-71:47<e&&e<58?e+4:43===e?62:47===e?63:0},ln);function ln(){}var pn,fn={pkceNotGenerated:{code:"pkce_not_created",desc:"The PKCE code challenge and verifier could not be generated."},cryptoDoesNotExist:{code:"crypto_nonexistent",desc:"The crypto object or function is not available."},httpMethodNotImplementedError:{code:"http_method_not_implemented",desc:"The HTTP method given has not been implemented in this library."},emptyNavigateUriError:{code:"empty_navigate_uri",desc:"Navigation URI is empty. Please check stack trace for more info."},hashEmptyError:{code:"hash_empty_error",desc:"Hash value cannot be processed because it is empty."},interactionInProgress:{code:"interaction_in_progress",desc:"Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API."},popUpWindowError:{code:"popup_window_error",desc:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser."},emptyWindowError:{code:"empty_window_error",desc:"window.open returned null or undefined window object."},userCancelledError:{code:"user_cancelled",desc:"User cancelled the flow."},monitorWindowTimeoutError:{code:"monitor_window_timeout",desc:"Token acquisition in popup failed due to timeout."},redirectInIframeError:{code:"redirect_in_iframe",desc:"Code flow is not supported inside an iframe. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs."},blockTokenRequestsInHiddenIframeError:{code:"block_iframe_reload",desc:"Request was blocked inside an iframe because MSAL detected an authentication response. Please ensure monitorWindowForHash was called."},iframeClosedPrematurelyError:{code:"iframe_closed_prematurely",desc:"The iframe being monitored was closed prematurely."},silentSSOInsufficientInfoError:{code:"silent_sso_error",desc:"Silent SSO could not be completed - insufficient information was provided. Please provide either a loginHint or sid."},silentPromptValueError:{code:"silent_prompt_value_error",desc:"The value given for the prompt value is not valid for silent requests - must be set to 'none'."},tokenRequestCacheError:{code:"token_request_cache_error",desc:"The token request could not be fetched from the cache correctly."},invalidCacheType:{code:"invalid_cache_type",desc:"Invalid cache type"},notInBrowserEnvironment:{code:"non_browser_environment",desc:"Login and token requests are not supported in non-browser environments."}},yn=(e(mn,pn=a),mn.createPkceNotGeneratedError=function(e){return new mn(fn.pkceNotGenerated.code,fn.pkceNotGenerated.desc+" Detail:"+e)},mn.createCryptoNotAvailableError=function(e){return new mn(fn.cryptoDoesNotExist.code,fn.cryptoDoesNotExist.desc+" Detail:"+e)},mn.createHttpMethodNotImplementedError=function(e){return new mn(fn.httpMethodNotImplementedError.code,fn.httpMethodNotImplementedError.desc+" Given Method: "+e)},mn.createEmptyNavigationUriError=function(){return new mn(fn.emptyNavigateUriError.code,fn.emptyNavigateUriError.desc)},mn.createEmptyHashError=function(e){return new mn(fn.hashEmptyError.code,fn.hashEmptyError.desc+" Given Url: "+e)},mn.createInteractionInProgressError=function(){return new mn(fn.interactionInProgress.code,fn.interactionInProgress.desc)},mn.createPopupWindowError=function(e){var t=fn.popUpWindowError.desc;return t=ne.isEmpty(e)?t:t+" Details: "+e,new mn(fn.popUpWindowError.code,t)},mn.createEmptyWindowCreatedError=function(){return new mn(fn.emptyWindowError.code,fn.emptyWindowError.desc)},mn.createUserCancelledError=function(){return new mn(fn.userCancelledError.code,fn.userCancelledError.desc)},mn.createMonitorWindowTimeoutError=function(){return new mn(fn.monitorWindowTimeoutError.code,fn.monitorWindowTimeoutError.desc)},mn.createRedirectInIframeError=function(e){return new mn(fn.redirectInIframeError.code,fn.redirectInIframeError.desc+" (window.parent !== window) => "+e)},mn.createBlockReloadInHiddenIframeError=function(){return new mn(fn.blockTokenRequestsInHiddenIframeError.code,fn.blockTokenRequestsInHiddenIframeError.desc)},mn.createIframeClosedPrematurelyError=function(){return new mn(fn.iframeClosedPrematurelyError.code,fn.iframeClosedPrematurelyError.desc)},mn.createSilentSSOInsufficientInfoError=function(){return new mn(fn.silentSSOInsufficientInfoError.code,fn.silentSSOInsufficientInfoError.desc)},mn.createSilentPromptValueError=function(e){return new mn(fn.silentPromptValueError.code,fn.silentPromptValueError.desc+" Given value: "+e)},mn.createTokenRequestCacheError=function(e){return new mn(fn.tokenRequestCacheError.code,fn.tokenRequestCacheError.desc+" Error Detail: "+e)},mn.createInvalidCacheTypeError=function(){return new mn(fn.invalidCacheType.code,""+fn.invalidCacheType.desc)},mn.createNonBrowserEnvironmentError=function(){return new mn(fn.notInBrowserEnvironment.code,fn.notInBrowserEnvironment.desc)},mn);function mn(e,t){var r=pn.call(this,e,t)||this;return Object.setPrototypeOf(r,mn.prototype),r.name="BrowserAuthError",r}var gn=(En.prototype.generateCodes=function(){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return t=this.generateCodeVerifier(),[4,this.generateCodeChallengeFromVerifier(t)];case 1:return r=e.sent(),[2,{verifier:t,challenge:r}]}})})},En.prototype.generateCodeVerifier=function(){try{var e=new Uint8Array(32);return this.cryptoObj.getRandomValues(e),this.base64Encode.urlEncodeArr(e)}catch(e){throw yn.createPkceNotGeneratedError(e)}},En.prototype.generateCodeChallengeFromVerifier=function(n){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.cryptoObj.sha256Digest(n)];case 1:return t=e.sent(),[2,this.base64Encode.urlEncodeArr(new Uint8Array(t))];case 2:throw r=e.sent(),yn.createPkceNotGeneratedError(r);case 3:return[2]}})})},En);function En(e){this.base64Encode=new un,this.cryptoObj=e}var vn="SHA-256",Cn=new Uint8Array([1,0,1]),Tn=(wn.prototype.sha256Digest=function(r){return p(this,void 0,void 0,function(){var t;return f(this,function(e){return t=an.stringToUtf8Arr(r),[2,this.hasIECrypto()?this.getMSCryptoDigest(vn,t):this.getSubtleCryptoDigest(vn,t)]})})},wn.prototype.getRandomValues=function(e){var t=window.msCrypto||window.crypto;if(!t.getRandomValues)throw yn.createCryptoNotAvailableError("getRandomValues does not exist.");t.getRandomValues(e)},wn.prototype.generateKeyPair=function(t,r){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.hasIECrypto()?this.msCryptoGenerateKey(t,r):window.crypto.subtle.generateKey(this._keygenAlgorithmOptions,t,r)]})})},wn.prototype.exportJwk=function(t){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.hasIECrypto()?this.msCryptoExportJwk(t):window.crypto.subtle.exportKey(tn,t)]})})},wn.prototype.importJwk=function(n,o,i){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){return t=wn.getJwkString(n),r=an.stringToArrayBuffer(t),[2,this.hasIECrypto()?this.msCryptoImportKey(r,o,i):window.crypto.subtle.importKey(tn,n,this._keygenAlgorithmOptions,o,i)]})})},wn.prototype.sign=function(t,r){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.hasIECrypto()?this.msCryptoSign(t,r):window.crypto.subtle.sign(this._keygenAlgorithmOptions,t,r)]})})},wn.prototype.hasCryptoAPI=function(){return this.hasIECrypto()||this.hasBrowserCrypto()},wn.prototype.hasIECrypto=function(){return"msCrypto"in window},wn.prototype.hasBrowserCrypto=function(){return"crypto"in window},wn.prototype.getSubtleCryptoDigest=function(t,r){return p(this,void 0,void 0,function(){return f(this,function(e){return console.log(t),[2,window.crypto.subtle.digest(t,r)]})})},wn.prototype.getMSCryptoDigest=function(n,o){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.digest(n,o.buffer);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},wn.prototype.msCryptoGenerateKey=function(o,i){return p(this,void 0,void 0,function(){var n=this;return f(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.generateKey(n._keygenAlgorithmOptions,o,i);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},wn.prototype.msCryptoExportJwk=function(t){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,new Promise(function(n,o){var e=window.msCrypto.subtle.exportKey(tn,t);e.addEventListener("complete",function(e){var t=e.target.result,r=an.utf8ArrToString(new Uint8Array(t)).replace(/\r/g,"").replace(/\n/g,"").replace(/\t/g,"").split(" ").join("").replace("\0","");try{n(JSON.parse(r))}catch(e){o(e)}}),e.addEventListener("error",function(e){o(e)})})]})})},wn.prototype.msCryptoImportKey=function(o,i,s){return p(this,void 0,void 0,function(){var n=this;return f(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.importKey(tn,o,n._keygenAlgorithmOptions,i,s);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},wn.prototype.msCryptoSign=function(o,i){return p(this,void 0,void 0,function(){var n=this;return f(this,function(e){return[2,new Promise(function(t,r){var e=window.msCrypto.subtle.sign(n._keygenAlgorithmOptions,o,i);e.addEventListener("complete",function(e){t(e.target.result)}),e.addEventListener("error",function(e){r(e)})})]})})},wn.getJwkString=function(e){return JSON.stringify(e,Object.keys(e).sort())},wn);function wn(){if(!this.hasCryptoAPI())throw yn.createCryptoNotAvailableError("Browser crypto or msCrypto object not available.");this._keygenAlgorithmOptions={name:"RSASSA-PKCS1-v1_5",hash:vn,modulusLength:2048,publicExponent:Cn}}var In=(An.prototype.open=function(){return p(this,void 0,void 0,function(){var n=this;return f(this,function(e){return[2,new Promise(function(t,r){var e=window.indexedDB.open(n.dbName,n.version);e.addEventListener("upgradeneeded",function(e){e.target.result.createObjectStore(n.tableName)}),e.addEventListener("success",function(e){n.db=e.target.result,n.dbOpen=!0,t()}),e.addEventListener("error",function(e){return r(e)})})]})})},An.prototype.get=function(o){return p(this,void 0,void 0,function(){var n=this;return f(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:e.sent(),e.label=2;case 2:return[2,new Promise(function(t,r){var e=n.db.transaction([n.tableName],"readonly").objectStore(n.tableName).get(o);e.addEventListener("success",function(e){return t(e.target.result)}),e.addEventListener("error",function(e){return r(e)})})]}})})},An.prototype.put=function(o,i){return p(this,void 0,void 0,function(){var n=this;return f(this,function(e){switch(e.label){case 0:return this.dbOpen?[3,2]:[4,this.open()];case 1:e.sent(),e.label=2;case 2:return[2,new Promise(function(t,r){var e=n.db.transaction([n.tableName],"readwrite").objectStore(n.tableName).put(i,o);e.addEventListener("success",function(e){return t(e.target.result)}),e.addEventListener("error",function(e){return r(e)})})]}})})},An);function An(e,t,r){this.dbName=e,this.tableName=t,this.version=r,this.dbOpen=!1}var Sn=(Rn.prototype.createNewGuid=function(){return this.guidGenerator.generateGuid()},Rn.prototype.base64Encode=function(e){return this.b64Encode.encode(e)},Rn.prototype.base64Decode=function(e){return this.b64Decode.decode(e)},Rn.prototype.generatePkceCodes=function(){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.pkceGenerator.generateCodes()]})})},Rn.prototype.getPublicKeyThumbprint=function(u,d){return p(this,void 0,void 0,function(){var t,r,n,o,i,s,a,c;return f(this,function(e){switch(e.label){case 0:return[4,this.browserCrypto.generateKeyPair(Rn.EXTRACTABLE,Rn.POP_KEY_USAGES)];case 1:return t=e.sent(),[4,this.browserCrypto.exportJwk(t.publicKey)];case 2:return r=e.sent(),n={e:r.e,kty:r.kty,n:r.n},o=Tn.getJwkString(n),[4,this.browserCrypto.sha256Digest(o)];case 3:return i=e.sent(),s=this.b64Encode.urlEncodeArr(new Uint8Array(i)),[4,this.browserCrypto.exportJwk(t.privateKey)];case 4:return a=e.sent(),[4,this.browserCrypto.importJwk(a,!1,["sign"])];case 5:return c=e.sent(),this.cache.put(s,{privateKey:c,publicKey:t.publicKey,requestMethod:u,requestUri:d}),[2,s]}})})},Rn.prototype.signJwt=function(h,l){return p(this,void 0,void 0,function(){var t,r,n,o,i,s,a,c,u,d;return f(this,function(e){switch(e.label){case 0:return[4,this.cache.get(l)];case 1:return t=e.sent(),[4,this.browserCrypto.exportJwk(t.publicKey)];case 2:return r=e.sent(),n=Tn.getJwkString(r),o={alg:r.alg,type:tn},i=this.b64Encode.urlEncode(JSON.stringify(o)),h.cnf={jwk:JSON.parse(n)},s=this.b64Encode.urlEncode(JSON.stringify(h)),a=i+"."+s,c=an.stringToArrayBuffer(a),[4,this.browserCrypto.sign(t.privateKey,c)];case 3:return u=e.sent(),d=this.b64Encode.urlEncodeArr(new Uint8Array(u)),[2,a+"."+d]}})})},Rn.POP_KEY_USAGES=["sign","verify"],Rn.EXTRACTABLE=!0,Rn.DB_VERSION=1,Rn.TABLE_NAME=(Rn.DB_NAME="msal.db")+".keys",Rn);function Rn(){this.browserCrypto=new Tn,this.b64Encode=new un,this.b64Decode=new hn,this.guidGenerator=new on(this.browserCrypto),this.pkceGenerator=new gn(this.browserCrypto),this.cache=new In(Rn.DB_NAME,Rn.TABLE_NAME,Rn.DB_VERSION)}var _n,On={redirectUriNotSet:{code:"redirect_uri_empty",desc:"A redirect URI is required for all calls, and none has been set."},postLogoutUriNotSet:{code:"post_logout_uri_empty",desc:"A post logout redirect has not been set."},storageNotSupportedError:{code:"storage_not_supported",desc:"Given storage configuration option was not supported."},noRedirectCallbacksSet:{code:"no_redirect_callbacks",desc:"No redirect callbacks have been set. Please call setRedirectCallbacks() with the appropriate function arguments before continuing. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."},invalidCallbackObject:{code:"invalid_callback_object",desc:"The object passed for the callback was invalid. More information is available here: https://github.com/AzureAD/microsoft-authentication-library-for-js/wiki/MSAL-basics."}},bn=(e(Nn,_n=a),Nn.createRedirectUriEmptyError=function(){return new Nn(On.redirectUriNotSet.code,On.redirectUriNotSet.desc)},Nn.createPostLogoutRedirectUriEmptyError=function(){return new Nn(On.postLogoutUriNotSet.code,On.postLogoutUriNotSet.desc)},Nn.createStorageNotSupportedError=function(e){return new Nn(On.storageNotSupportedError.code,On.storageNotSupportedError.desc+" Given Location: "+e)},Nn.createInvalidCallbackObjectError=function(e){return new Nn(On.invalidCallbackObject.code,On.invalidCallbackObject.desc+" Given value for callback function: "+e)},Nn.createRedirectCallbacksNotSetError=function(){return new Nn(On.noRedirectCallbacksSet.code,On.noRedirectCallbacksSet.desc)},Nn);function Nn(e,t){var r=_n.call(this,e,t)||this;return r.name="BrowserConfigurationAuthError",Object.setPrototypeOf(r,Nn.prototype),r}var kn,Pn=(e(Un,kn=Ot),Un.prototype.validateWindowStorage=function(e){if(e!==$r.CACHE_LOCATION_LOCAL&&e!==$r.CACHE_LOCATION_SESSION)throw bn.createStorageNotSupportedError(e);if(!window[e])throw bn.createStorageNotSupportedError(e)},Un.prototype.migrateCacheEntries=function(){var r=this,e=ge.CACHE_PREFIX+"."+ue.ID_TOKEN,t=ge.CACHE_PREFIX+"."+ue.CLIENT_INFO,n=ge.CACHE_PREFIX+"."+ue.ERROR,o=ge.CACHE_PREFIX+"."+ue.ERROR_DESC,i=[this.windowStorage.getItem(e),this.windowStorage.getItem(t),this.windowStorage.getItem(n),this.windowStorage.getItem(o)];[ue.ID_TOKEN,ue.CLIENT_INFO,ue.ERROR,ue.ERROR_DESC].forEach(function(e,t){return r.migrateCacheEntry(e,i[t])})},Un.prototype.migrateCacheEntry=function(e,t){t&&this.setItem(this.generateCacheKey(e),t,ke.TEMPORARY)},Un.prototype.validateObjectKey=function(e){JSON.parse(e)},Un.prototype.setItem=function(e,t,r){switch(r){case ke.ACCOUNT:case ke.CREDENTIAL:case ke.APP_METADATA:case ke.THROTTLING:this.windowStorage.setItem(e,JSON.stringify(t));break;case ke.TEMPORARY:var n=t;this.windowStorage.setItem(e,n),this.cacheConfig.storeAuthStateInCookie&&this.setItemCookie(e,n);break;case ke.TELEMETRY:this.windowStorage.setItem(e,JSON.stringify(t));break;default:throw yn.createInvalidCacheTypeError()}},Un.prototype.getItem=function(e,t){var r=this.windowStorage.getItem(e);if(ne.isEmpty(r))return null;switch(t){case ke.ACCOUNT:var n=new At;return Ot.toObject(n,JSON.parse(r));case ke.CREDENTIAL:switch(Be.getCredentialType(e)){case be.ID_TOKEN:var o=new or;return Ot.toObject(o,JSON.parse(r));case be.ACCESS_TOKEN:var i=new ar;return Ot.toObject(i,JSON.parse(r));case be.REFRESH_TOKEN:var s=new dr;return Ot.toObject(s,JSON.parse(r))}case ke.APP_METADATA:case ke.THROTTLING:return JSON.parse(r);case ke.TEMPORARY:var a=this.getItemCookie(e);return this.cacheConfig.storeAuthStateInCookie?a:r;case ke.TELEMETRY:return JSON.parse(r);default:throw yn.createInvalidCacheTypeError()}},Un.prototype.removeItem=function(e){return this.windowStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&this.clearItemCookie(e),!0},Un.prototype.containsKey=function(e){return this.windowStorage.hasOwnProperty(e)},Un.prototype.getKeys=function(){return Object.keys(this.windowStorage)},Un.prototype.clear=function(){var e;for(e in this.removeAllAccounts(),this.removeAppMetadata(),this.windowStorage)!this.windowStorage.hasOwnProperty(e)||-1===e.indexOf(ge.CACHE_PREFIX)&&-1===e.indexOf(this.clientId)||this.removeItem(e)},Un.prototype.setItemCookie=function(e,t,r){var n=encodeURIComponent(e)+"="+encodeURIComponent(t)+";path=/;";r&&(n+="expires="+this.getCookieExpirationTime(r)+";"),document.cookie=n},Un.prototype.getItemCookie=function(e){for(var t=encodeURIComponent(e)+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var o=r[n];" "===o.charAt(0);)o=o.substring(1);if(0===o.indexOf(t))return decodeURIComponent(o.substring(t.length,o.length))}return""},Un.prototype.clearItemCookie=function(e){this.setItemCookie(e,"",-1)},Un.prototype.clearMsalCookie=function(e){var t=e?this.generateNonceKey(e):this.generateStateKey(Vr.NONCE_IDTOKEN);this.clearItemCookie(this.generateStateKey(e)),this.clearItemCookie(t),this.clearItemCookie(this.generateCacheKey(Vr.ORIGIN_URI))},Un.prototype.getCookieExpirationTime=function(e){var t=new Date;return new Date(t.getTime()+864e5*e).toUTCString()},Un.prototype.getCache=function(){return this.windowStorage},Un.prototype.setCache=function(){},Un.prototype.generateCacheKey=function(t){try{return this.validateObjectKey(t),t}catch(e){return ne.startsWith(t,ge.CACHE_PREFIX)||ne.startsWith(t,ue.ADAL_ID_TOKEN)?t:ge.CACHE_PREFIX+"."+this.clientId+"."+t}},Un.prototype.generateAuthorityKey=function(e){var t=Cr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Vr.AUTHORITY+"."+t)},Un.prototype.generateNonceKey=function(e){var t=Cr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Vr.NONCE_IDTOKEN+"."+t)},Un.prototype.generateStateKey=function(e){var t=Cr.parseRequestState(this.cryptoImpl,e).libraryState.id;return this.generateCacheKey(Vr.REQUEST_STATE+"."+t)},Un.prototype.setAuthorityCache=function(e,t){this.setItem(this.generateAuthorityKey(t),e,ke.TEMPORARY)},Un.prototype.getCachedAuthority=function(e){var t=this.getItem(this.generateStateKey(e),ke.TEMPORARY);return t?this.getItem(this.generateAuthorityKey(t),ke.TEMPORARY):null},Un.prototype.updateCacheEntries=function(e,t,r){this.setItem(this.generateStateKey(e),e,ke.TEMPORARY),this.setItem(this.generateNonceKey(e),t,ke.TEMPORARY),this.setAuthorityCache(r,e)},Un.prototype.resetRequestCache=function(t){var r=this;this.getKeys().forEach(function(e){ne.isEmpty(t)||-1===e.indexOf(t)||r.removeItem(e)}),t&&(this.removeItem(this.generateStateKey(t)),this.removeItem(this.generateNonceKey(t)),this.removeItem(this.generateAuthorityKey(t))),this.removeItem(this.generateCacheKey(Vr.REQUEST_PARAMS)),this.removeItem(this.generateCacheKey(Vr.ORIGIN_URI)),this.removeItem(this.generateCacheKey(Vr.URL_HASH))},Un.prototype.cleanRequest=function(e){if(this.removeItem(this.generateCacheKey($r.INTERACTION_STATUS_KEY)),e){var t=this.getItem(this.generateStateKey(e),ke.TEMPORARY);this.resetRequestCache(t||"")}},Un.prototype.cacheCodeRequest=function(e,t){this.setItem(this.generateCacheKey(Vr.REQUEST_PARAMS),t.base64Encode(JSON.stringify(e)),ke.TEMPORARY)},Un.prototype.getCachedRequest=function(e,t){try{var r=this.getItem(this.generateCacheKey(Vr.REQUEST_PARAMS),ke.TEMPORARY),n=JSON.parse(t.base64Decode(r));if(this.removeItem(this.generateCacheKey(Vr.REQUEST_PARAMS)),ne.isEmpty(n.authority)){var o=this.getItem(this.generateAuthorityKey(e),ke.TEMPORARY);n.authority=o}return n}catch(e){throw yn.createTokenRequestCacheError(e)}},Un);function Un(e,t,r){var n=kn.call(this)||this;return n.validateWindowStorage(t.cacheLocation),n.cacheConfig=t,n.windowStorage=window[n.cacheConfig.cacheLocation],n.clientId=e,n.cryptoImpl=r,n.migrateCacheEntries(),n}var Ln=(Mn.prototype.sendGetRequestAsync=function(n,o){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return[4,fetch(n,{method:Yr.GET,headers:this.getFetchHeaders(o)})];case 1:return t=e.sent(),r={headers:this.getHeaderDict(t.headers)},[4,t.json()];case 2:return[2,(r.body=e.sent(),r.status=t.status,r)]}})})},Mn.prototype.sendPostRequestAsync=function(o,i){return p(this,void 0,void 0,function(){var t,r,n;return f(this,function(e){switch(e.label){case 0:return t=i&&i.body||"",[4,fetch(o,{method:Yr.POST,headers:this.getFetchHeaders(i),body:t})];case 1:return r=e.sent(),n={headers:this.getHeaderDict(r.headers)},[4,r.json()];case 2:return[2,(n.body=e.sent(),n.status=r.status,n)]}})})},Mn.prototype.getFetchHeaders=function(t){var r=new Headers;return t&&t.headers&&Object.keys(t.headers).forEach(function(e){r.append(e,t.headers[e])}),r},Mn.prototype.getHeaderDict=function(e){var r={};return e.forEach(function(e,t){r[t]=e}),r},Mn);function Mn(){}var Dn=(qn.prototype.sendGetRequestAsync=function(t,r){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.sendRequestAsync(t,Yr.GET,r)]})})},qn.prototype.sendPostRequestAsync=function(t,r){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.sendRequestAsync(t,Yr.POST,r)]})})},qn.prototype.sendRequestAsync=function(e,t,i){var s=this;return new Promise(function(r,n){var o=new XMLHttpRequest;if(o.open(t,e,!0),s.setXhrHeaders(o,i),o.onload=function(){(o.status<200||300<=o.status)&&n(o.responseText);try{var e=JSON.parse(o.responseText),t={headers:s.getHeaderDict(o),body:e,status:o.status};r(t)}catch(e){n(o.responseText)}},o.onerror=function(){n(o.status)},"POST"===t&&i.body)o.send(i.body);else{if("GET"!==t)throw yn.createHttpMethodNotImplementedError(t);o.send()}})},qn.prototype.setXhrHeaders=function(t,r){r&&r.headers&&Object.keys(r.headers).forEach(function(e){t.setRequestHeader(e,r.headers[e])})},qn.prototype.getHeaderDict=function(e){var t=e.getAllResponseHeaders().trim().split(/[\r\n]+/),o={};return t.forEach(function(e){var t=e.split(": "),r=t.shift(),n=t.join(": ");o[r]=n}),o},qn);function qn(){}var Hn=(Kn.navigateWindow=function(e,t){t?window.location.replace(e):window.location.assign(e)},Kn.clearHash=function(){window.location.hash=""},Kn.replaceHash=function(e){var t=e.split("#");t.shift(),window.location.hash=0<t.length?t.join("#"):""},Kn.isInIframe=function(){return window.parent!==window},Kn.getCurrentUri=function(){return window.location.href.split("?")[0].split("#")[0]},Kn.getHomepage=function(){var e=new gt(window.location.href).getUrlComponents();return e.Protocol+"//"+e.HostNameAndPort+"/"},Kn.getBrowserNetworkClient=function(){return window.fetch?new Ln:new Dn},Kn.blockReloadInHiddenIframes=function(){if(gt.hashContainsKnownProperties(window.location.hash)&&Kn.isInIframe())throw yn.createBlockReloadInHiddenIframeError()},Kn.blockNonBrowserEnvironment=function(e){if(!e)throw yn.createNonBrowserEnvironmentError()},Kn.detectIEOrEdge=function(){var e=window.navigator.userAgent,t=e.indexOf("MSIE "),r=e.indexOf("Trident/"),n=e.indexOf("Edge/");return 0<t||0<r||0<n},Kn);function Kn(){}var xn=6e4,Fn=6e3;var Gn=(jn.extractBrowserRequestState=function(e,t){if(ne.isEmpty(t))return null;try{return Cr.parseRequestState(e,t).libraryState.meta}catch(e){throw ee.createInvalidStateError(t,e)}},jn.parseServerResponseFromHash=function(e){if(!e)return{};var t=new gt(e);return gt.getDeserializedHash(t.getHash())},jn);function jn(){}var Bn=(Yn.prototype.handleCodeResponse=function(s){return p(this,void 0,void 0,function(){var t,r,n,o,i;return f(this,function(e){switch(e.label){case 0:if(ne.isEmpty(s))throw yn.createEmptyHashError(s);return t=Gn.parseServerResponseFromHash(s),r=this.browserStorage.getItem(this.browserStorage.generateStateKey(t.state),ke.TEMPORARY),n=this.authModule.handleFragmentResponse(s,r),o=this.browserStorage.getItem(this.browserStorage.generateNonceKey(r),ke.TEMPORARY),this.authCodeRequest.code=n,[4,this.authModule.acquireToken(this.authCodeRequest,o,r)];case 1:return i=e.sent(),this.browserStorage.cleanRequest(t.state),[2,i]}})})},Yn);function Yn(e,t){this.authModule=e,this.browserStorage=t}var zn,Vn=(e(Wn,zn=Bn),Wn.prototype.initiateAuthRequest=function(e,t,r,n){if(ne.isEmpty(e))throw this.authModule.logger.info("Navigate url is empty"),yn.createEmptyNavigationUriError();r&&this.browserStorage.setItem(this.browserStorage.generateCacheKey(Vr.ORIGIN_URI),r,ke.TEMPORARY),this.browserStorage.setItem(this.browserStorage.generateCacheKey($r.INTERACTION_STATUS_KEY),$r.INTERACTION_IN_PROGRESS_VALUE,ke.TEMPORARY),this.browserStorage.cacheCodeRequest(t,n),this.authModule.logger.infoPii("Navigate to:"+e);var o=Hn.isInIframe();if(o)throw yn.createRedirectInIframeError(o);return Hn.navigateWindow(e),window},Wn.prototype.handleCodeResponse=function(s,a,c){return p(this,void 0,void 0,function(){var t,r,n,o,i;return f(this,function(e){switch(e.label){case 0:if(ne.isEmpty(s))throw yn.createEmptyHashError(s);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey($r.INTERACTION_STATUS_KEY)),t=Gn.parseServerResponseFromHash(s),r=this.browserStorage.getItem(this.browserStorage.generateStateKey(t.state),ke.TEMPORARY),n=this.authModule.handleFragmentResponse(s,r),o=this.browserStorage.getItem(this.browserStorage.generateNonceKey(r),ke.TEMPORARY),this.authCodeRequest=this.browserStorage.getCachedRequest(r,a),this.authCodeRequest.code=n,c&&jt.removeThrottle(this.browserStorage,c,this.authCodeRequest.authority,this.authCodeRequest.scopes),[4,this.authModule.acquireToken(this.authCodeRequest,o,r)];case 1:return i=e.sent(),this.browserStorage.cleanRequest(t.state),[2,i]}})})},Wn);function Wn(){return null!==zn&&zn.apply(this,arguments)||this}var Jn,Qn=(e(Xn,Jn=Bn),Xn.prototype.initiateAuthRequest=function(e,t,r){if(ne.isEmpty(e))throw this.authModule.logger.error("Navigate url is empty"),yn.createEmptyNavigationUriError();return this.authCodeRequest=t,this.browserStorage.setItem(this.browserStorage.generateCacheKey($r.INTERACTION_STATUS_KEY),$r.INTERACTION_IN_PROGRESS_VALUE,ke.TEMPORARY),this.authModule.logger.infoPii("Navigate to:"+e),this.openPopup(e,r)},Xn.prototype.monitorPopupForHash=function(a,e){var c=this;return new Promise(function(r,n){var o=e/$r.POLL_INTERVAL_MS,i=0,s=setInterval(function(){if(a.closed)return c.cleanPopup(),clearInterval(s),void n(yn.createUserCancelledError());var e;try{e=a.location.href}catch(e){}if(!ne.isEmpty(e)&&"about:blank"!==e){i++;var t=a.location.hash;return gt.hashContainsKnownProperties(t)?(c.cleanPopup(a),clearInterval(s),void r(t)):o<i?(c.cleanPopup(a),clearInterval(s),void n(yn.createMonitorWindowTimeoutError())):void 0}},$r.POLL_INTERVAL_MS)})},Xn.prototype.openPopup=function(e,t){try{var r=void 0;if(t?(r=t).location.assign(e):void 0===t&&(r=Xn.openSizedPopup(e)),!r)throw yn.createEmptyWindowCreatedError();return r.focus&&r.focus(),this.currentWindow=r,window.addEventListener("beforeunload",this.unloadWindow),r}catch(e){throw this.authModule.logger.error("error opening popup "+e.message),this.browserStorage.removeItem(this.browserStorage.generateCacheKey($r.INTERACTION_STATUS_KEY)),yn.createPopupWindowError(e.toString())}},Xn.openSizedPopup=function(e){void 0===e&&(e="about:blank");var t=window.screenLeft?window.screenLeft:window.screenX,r=window.screenTop?window.screenTop:window.screenY,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,o=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,i=Math.max(0,n/2-$r.POPUP_WIDTH/2+t),s=Math.max(0,o/2-$r.POPUP_HEIGHT/2+r);return window.open(e,ge.LIBRARY_NAME,"width="+$r.POPUP_WIDTH+", height="+$r.POPUP_HEIGHT+", top="+s+", left="+i)},Xn.prototype.unloadWindow=function(e){this.browserStorage.cleanRequest(),this.currentWindow.close(),delete e.returnValue},Xn.prototype.cleanPopup=function(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.removeItem(this.browserStorage.generateCacheKey($r.INTERACTION_STATUS_KEY))},Xn);function Xn(e,t){var r=Jn.call(this,e,t)||this;return r.unloadWindow=r.unloadWindow.bind(r),r}var Zn,$n=(e(eo,Zn=Bn),eo.prototype.initiateAuthRequest=function(r,n){return p(this,void 0,void 0,function(){var t;return f(this,function(e){switch(e.label){case 0:if(ne.isEmpty(r))throw this.authModule.logger.info("Navigate url is empty"),yn.createEmptyNavigationUriError();return this.authCodeRequest=n,this.loadFrameTimeout?[4,this.loadFrame(r)]:[3,2];case 1:return t=e.sent(),[3,3];case 2:t=this.loadFrameSync(r),e.label=3;case 3:return[2,t]}})})},eo.prototype.monitorIframeForHash=function(s,e){var a=this;return new Promise(function(r,n){var o=window.performance.now()+e,i=setInterval(function(){if(window.performance.now()>o)return a.removeHiddenIframe(s),clearInterval(i),void n(yn.createMonitorWindowTimeoutError());var e;try{e=s.contentWindow.location.href}catch(e){}if(!ne.isEmpty(e)){var t=s.contentWindow.location.hash;return gt.hashContainsKnownProperties(t)?(a.removeHiddenIframe(s),clearInterval(i),void r(t)):void 0}},$r.POLL_INTERVAL_MS)})},eo.prototype.loadFrame=function(n){var o=this;return new Promise(function(t,r){setTimeout(function(){var e=o.loadFrameSync(n);e?t(e):r("Unable to load iframe")},o.loadFrameTimeout)})},eo.prototype.loadFrameSync=function(e){var t=this.createHiddenIframe();return t.src=e,t},eo.prototype.createHiddenIframe=function(){var e=document.createElement("iframe");return e.style.visibility="hidden",e.style.position="absolute",e.style.width=e.style.height="0",e.style.border="0",e.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.getElementsByTagName("body")[0].appendChild(e),e},eo.prototype.removeHiddenIframe=function(e){document.body===e.parentNode&&document.body.removeChild(e)},eo);function eo(e,t,r){var n=Zn.call(this,e,t)||this;return n.loadFrameTimeout=r,n}var to=(ro.prototype.handleRedirectPromise=function(){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.isBrowserEnvironment?this.handleRedirectResponse():null]})})},ro.prototype.handleRedirectResponse=function(){return p(this,void 0,void 0,function(){var t,r,n,o,i,s;return f(this,function(e){return this.interactionInProgress()?(t=this.getRedirectResponseHash(),ne.isEmpty(t)?[2,null]:(r=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Vr.ORIGIN_URI),ke.TEMPORARY),n=gt.removeHashFromUrl(r||""),o=gt.removeHashFromUrl(window.location.href),n===o&&this.config.auth.navigateToLoginRequestUrl?(-1<r.indexOf("#")&&Hn.replaceHash(r),[2,this.handleHash(t)]):this.config.auth.navigateToLoginRequestUrl?(Hn.isInIframe()||(i=this.browserStorage.generateCacheKey(Vr.URL_HASH),this.browserStorage.setItem(i,t,ke.TEMPORARY),r&&"null"!==r?Hn.navigateWindow(r,!0):(s=Hn.getHomepage(),this.browserStorage.setItem(this.browserStorage.generateCacheKey(Vr.ORIGIN_URI),s,ke.TEMPORARY),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),Hn.navigateWindow(s,!0))),[2,null]):[2,this.handleHash(t)])):(this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),[2,null])})})},ro.prototype.getRedirectResponseHash=function(){var e=window.location.hash,t=gt.hashContainsKnownProperties(e),r=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Vr.URL_HASH),ke.TEMPORARY);this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Vr.URL_HASH));var n=t?e:r;if(n){var o=gt.getDeserializedHash(n);return Gn.extractBrowserRequestState(this.browserCrypto,o.state).interactionType!==Xr.REDIRECT?null:(Hn.clearHash(),n)}var i=Gn.parseServerResponseFromHash(e);return this.browserStorage.cleanRequest(i.state),null},ro.prototype.handleHash=function(c){return p(this,void 0,void 0,function(){var t,r,n,o,i,s,a;return f(this,function(e){switch(e.label){case 0:t=this.browserStorage.getItem(this.browserStorage.generateCacheKey(Vr.REQUEST_PARAMS),ke.TEMPORARY),r=JSON.parse(this.browserCrypto.base64Decode(t)),n=this.initializeServerTelemetryManager(Jr.handleRedirectPromise,r.correlationId),new gt(c),o=Gn.parseServerResponseFromHash(c),e.label=1;case 1:return e.trys.push([1,4,,5]),i=this.browserStorage.getCachedAuthority(o.state),[4,this.createAuthCodeClient(n,i)];case 2:return s=e.sent(),[4,new Vn(s,this.browserStorage).handleCodeResponse(c,this.browserCrypto,this.config.auth.clientId)];case 3:return[2,e.sent()];case 4:throw a=e.sent(),n.cacheFailedRequest(a),this.browserStorage.cleanRequest(o.state),a;case 5:return[2]}})})},ro.prototype.acquireTokenRedirect=function(u){return p(this,void 0,void 0,function(){var t,r,n,o,i,s,a,c;return f(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(),t=this.preflightInteractiveRequest(u,Xr.REDIRECT),r=this.initializeServerTelemetryManager(Jr.acquireTokenRedirect,t.correlationId),e.label=1;case 1:return e.trys.push([1,5,,6]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=e.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return o=e.sent(),i=new Vn(o,this.browserStorage),[4,o.getAuthCodeUrl(t)];case 4:return s=e.sent(),a=u&&u.redirectStartPage||window.location.href,i.initiateAuthRequest(s,n,a,this.browserCrypto),[3,6];case 5:throw c=e.sent(),r.cacheFailedRequest(c),this.browserStorage.cleanRequest(t.state),c;case 6:return[2]}})})},ro.prototype.acquireTokenPopup=function(e){try{this.preflightBrowserEnvironmentCheck()}catch(e){return Promise.reject(e)}if(this.config.system.asyncPopups)return this.acquireTokenPopupAsync(e);var t=Qn.openSizedPopup();return this.acquireTokenPopupAsync(e,t)},ro.prototype.acquireTokenPopupAsync=function(d,h){return p(this,void 0,void 0,function(){var t,r,n,o,i,s,a,c,u;return f(this,function(e){switch(e.label){case 0:t=this.preflightInteractiveRequest(d,Xr.POPUP),r=this.initializeServerTelemetryManager(Jr.acquireTokenPopup,t.correlationId),e.label=1;case 1:return e.trys.push([1,7,,8]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=e.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return[4,(o=e.sent()).getAuthCodeUrl(t)];case 4:return i=e.sent(),s=new Qn(o,this.browserStorage),a=s.initiateAuthRequest(i,n,h),[4,s.monitorPopupForHash(a,this.config.system.windowHashTimeout)];case 5:return c=e.sent(),jt.removeThrottle(this.browserStorage,this.config.auth.clientId,n.authority,n.scopes),[4,s.handleCodeResponse(c)];case 6:return[2,e.sent()];case 7:throw u=e.sent(),r.cacheFailedRequest(u),this.browserStorage.cleanRequest(t.state),u;case 8:return[2]}})})},ro.prototype.ssoSilent=function(a){return p(this,void 0,void 0,function(){var t,r,n,o,i,s;return f(this,function(e){switch(e.label){case 0:if(this.preflightBrowserEnvironmentCheck(),ne.isEmpty(a.loginHint)&&ne.isEmpty(a.sid)&&(!a.account||ne.isEmpty(a.account.username)))throw yn.createSilentSSOInsufficientInfoError();if(a.prompt&&a.prompt!==Ce.NONE)throw yn.createSilentPromptValueError(a.prompt);t=this.initializeAuthorizationRequest(c(c({},a),{prompt:Ce.NONE}),Xr.SILENT),r=this.initializeServerTelemetryManager(Jr.ssoSilent,t.correlationId),e.label=1;case 1:return e.trys.push([1,6,,7]),[4,this.initializeAuthorizationCodeRequest(t)];case 2:return n=e.sent(),[4,this.createAuthCodeClient(r,t.authority)];case 3:return[4,(o=e.sent()).getAuthCodeUrl(t)];case 4:return i=e.sent(),[4,this.silentTokenHelper(i,n,o)];case 5:return[2,e.sent()];case 6:throw s=e.sent(),r.cacheFailedRequest(s),this.browserStorage.cleanRequest(t.state),s;case 7:return[2]}})})},ro.prototype.acquireTokenByRefreshToken=function(a){return p(this,void 0,void 0,function(){var t,r,n,o,i,s;return f(this,function(e){switch(e.label){case 0:Hn.blockReloadInHiddenIframes(),t=c(c({},a),this.initializeBaseRequest(a)),r=this.initializeServerTelemetryManager(Jr.acquireTokenSilent_silentFlow,t.correlationId),e.label=1;case 1:return e.trys.push([1,4,,7]),[4,this.createRefreshTokenClient(r,t.authority)];case 2:return[4,e.sent().acquireTokenByRefreshToken(t)];case 3:return[2,e.sent()];case 4:return n=e.sent(),r.cacheFailedRequest(n),o=n instanceof Ft,i=n instanceof yr,s=n.errorCode===$r.INVALID_GRANT_ERROR,o&&s&&!i?[4,this.ssoSilent(a)]:[3,6];case 5:return[2,e.sent()];case 6:throw n;case 7:return[2]}})})},ro.prototype.silentTokenHelper=function(o,i,s){return p(this,void 0,void 0,function(){var t,r,n;return f(this,function(e){switch(e.label){case 0:return[4,(t=new $n(s,this.browserStorage,this.config.system.loadFrameTimeout)).initiateAuthRequest(o,i)];case 1:return r=e.sent(),[4,t.monitorIframeForHash(r,this.config.system.iframeHashTimeout)];case 2:return n=e.sent(),[2,t.handleCodeResponse(n)]}})})},ro.prototype.logout=function(o){return p(this,void 0,void 0,function(){var t,r,n;return f(this,function(e){switch(e.label){case 0:return this.preflightBrowserEnvironmentCheck(),t=this.initializeLogoutRequest(o),[4,this.createAuthCodeClient(null,t&&t.authority)];case 1:return r=e.sent(),n=r.getLogoutUri(t),Hn.navigateWindow(n),[2]}})})},ro.prototype.getAllAccounts=function(){return this.isBrowserEnvironment?this.browserStorage.getAllAccounts():[]},ro.prototype.getAccountByUsername=function(t){var e=this.getAllAccounts();return!ne.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.username.toLowerCase()===t.toLowerCase()})[0]||null},ro.prototype.getAccountByHomeId=function(t){var e=this.getAllAccounts();return!ne.isEmpty(t)&&e&&e.length&&e.filter(function(e){return e.homeAccountId===t})[0]||null},ro.prototype.getRedirectUri=function(e){return e||this.config.auth.redirectUri||Hn.getCurrentUri()},ro.prototype.getPostLogoutRedirectUri=function(e){return e||this.config.auth.postLogoutRedirectUri||Hn.getCurrentUri()},ro.prototype.getDiscoveredDefaultAuthority=function(){return p(this,void 0,void 0,function(){var t;return f(this,function(e){switch(e.label){case 0:return this.defaultAuthority?[3,2]:(t=this,[4,Fr.createDiscoveredInstance(this.config.auth.authority,this.config.system.networkClient)]);case 1:t.defaultAuthority=e.sent(),e.label=2;case 2:return[2,this.defaultAuthority]}})})},ro.prototype.interactionInProgress=function(){return this.browserStorage.getItem(this.browserStorage.generateCacheKey($r.INTERACTION_STATUS_KEY),ke.TEMPORARY)===$r.INTERACTION_IN_PROGRESS_VALUE},ro.prototype.createAuthCodeClient=function(r,n){return p(this,void 0,void 0,function(){var t;return f(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new _r(t)]}})})},ro.prototype.createSilentFlowClient=function(r,n){return p(this,void 0,void 0,function(){var t;return f(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new Kr(t)]}})})},ro.prototype.createRefreshTokenClient=function(r,n){return p(this,void 0,void 0,function(){var t;return f(this,function(e){switch(e.label){case 0:return[4,this.getClientConfiguration(r,n)];case 1:return t=e.sent(),[2,new Pr(t)]}})})},ro.prototype.getClientConfiguration=function(n,o){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return ne.isEmpty(o)||o===this.config.auth.authority?[3,2]:[4,Fr.createDiscoveredInstance(o,this.config.system.networkClient)];case 1:return r=e.sent(),[3,4];case 2:return[4,this.getDiscoveredDefaultAuthority()];case 3:r=e.sent(),e.label=4;case 4:return t=r,[2,{authOptions:{clientId:this.config.auth.clientId,authority:t,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds},loggerOptions:{loggerCallback:this.config.system.loggerOptions.loggerCallback,piiLoggingEnabled:this.config.system.loggerOptions.piiLoggingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:n,libraryInfo:{sku:$r.MSAL_SKU,version:"2.3.0",cpu:"",os:""}}]}})})},ro.prototype.preflightInteractiveRequest=function(e,t){if(Hn.blockReloadInHiddenIframes(),this.interactionInProgress())throw yn.createInteractionInProgressError();return this.initializeAuthorizationRequest(e,t)},ro.prototype.preflightBrowserEnvironmentCheck=function(){Hn.blockNonBrowserEnvironment(this.isBrowserEnvironment),Hn.blockReloadInHiddenIframes()},ro.prototype.initializeBaseRequest=function(e){var t=c({},e);return ne.isEmpty(t.authority)&&(t.authority=this.config.auth.authority),t.correlationId=e&&e.correlationId||this.browserCrypto.createNewGuid(),t},ro.prototype.initializeServerTelemetryManager=function(e,t,r){var n={clientId:this.config.auth.clientId,correlationId:t,apiId:e,forceRefresh:r||!1};return new jr(n,this.browserStorage)},ro.prototype.setDefaultScopes=function(e){return c(c({},e),{scopes:function(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)n[o]=i[s];return n}(e&&e.scopes||[])})},ro.prototype.initializeAuthorizationRequest=function(e,t){var r=c(c({},e),this.setDefaultScopes(e));if(r.redirectUri=this.getRedirectUri(r.redirectUri),ne.isEmpty(r.loginHint)){var n=this.browserStorage.getItem(ue.ADAL_ID_TOKEN,ke.TEMPORARY);if(!ne.isEmpty(n)){var o=new $t(n,this.browserCrypto);this.browserStorage.removeItem(ue.ADAL_ID_TOKEN),o.claims&&o.claims.upn&&(r.loginHint=o.claims.upn)}}var i={interactionType:t};return r.state=Cr.setRequestState(this.browserCrypto,e&&e.state||"",i),ne.isEmpty(r.nonce)&&(r.nonce=this.browserCrypto.createNewGuid()),r.responseMode=Te.FRAGMENT,r=c(c({},r),this.initializeBaseRequest(r)),this.browserStorage.updateCacheEntries(r.state,r.nonce,r.authority),r},ro.prototype.initializeAuthorizationCodeRequest=function(n){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:return[4,this.browserCrypto.generatePkceCodes()];case 1:return t=e.sent(),r=c(c({},n),{redirectUri:n.redirectUri,code:"",codeVerifier:t.verifier}),n.codeChallenge=t.challenge,n.codeChallengeMethod=ge.S256_CODE_CHALLENGE_METHOD,[2,r]}})})},ro.prototype.initializeLogoutRequest=function(e){var t=c({},e);return ne.isEmpty(t.authority)&&(t.authority=this.config.auth.authority),t.correlationId=t&&t.correlationId||this.browserCrypto.createNewGuid(),t.postLogoutRedirectUri=this.getPostLogoutRedirectUri(e?e.postLogoutRedirectUri:""),t},ro);function ro(e){this.isBrowserEnvironment="undefined"!=typeof window,this.isBrowserEnvironment&&(this.config=function(e){var t=e.auth,r=e.cache,n=e.system,o={clientId:"",authority:""+ge.DEFAULT_AUTHORITY,knownAuthorities:[],cloudDiscoveryMetadata:"",redirectUri:"",postLogoutRedirectUri:"",navigateToLoginRequestUrl:!0,clientCapabilities:[]},i={cacheLocation:$r.CACHE_LOCATION_SESSION,storeAuthStateInCookie:!1},s=c(c({},Lt),{loggerOptions:{loggerCallback:function(){},piiLoggingEnabled:!1},networkClient:Hn.getBrowserNetworkClient(),windowHashTimeout:xn,iframeHashTimeout:Fn,loadFrameTimeout:Hn.detectIEOrEdge()?500:0,asyncPopups:!1});return{auth:c(c({},o),t),cache:c(c({},i),r),system:c(c({},s),n)}}(e),this.browserCrypto=new Sn,this.networkClient=this.config.system.networkClient,this.browserStorage=new Pn(this.config.auth.clientId,this.config.cache,this.browserCrypto),this.logger=new ie(this.config.system.loggerOptions),vt.setTrustedAuthoritiesFromConfig(this.config.auth.knownAuthorities,this.config.auth.cloudDiscoveryMetadata),this.defaultAuthority=null)}var no,oo=(e(io,no=to),io.prototype.loginRedirect=function(t){return p(this,void 0,void 0,function(){return f(this,function(e){return[2,this.acquireTokenRedirect(t||en)]})})},io.prototype.loginPopup=function(e){return this.acquireTokenPopup(e||en)},io.prototype.acquireTokenSilent=function(n){return p(this,void 0,void 0,function(){var t,r;return f(this,function(e){switch(e.label){case 0:this.preflightBrowserEnvironmentCheck(),t=c(c({},n),this.initializeBaseRequest(n)),e.label=1;case 1:return e.trys.push([1,4,,5]),r=this.initializeServerTelemetryManager(Jr.acquireTokenSilent_silentFlow,t.correlationId),[4,this.createSilentFlowClient(r,t.authority)];case 2:return[4,e.sent().acquireCachedToken(t)];case 3:return[2,e.sent()];case 4:return e.sent(),[2,this.acquireTokenByRefreshToken(n)];case 5:return[2]}})})},io);function io(e){return no.call(this,e)||this}y.AuthError=a,y.AuthErrorMessage=r,y.BrowserAuthError=yn,y.BrowserAuthErrorMessage=fn,y.BrowserConfigurationAuthError=bn,y.BrowserConfigurationAuthErrorMessage=On,y.InteractionRequiredAuthError=yr,y.Logger=ie,y.PublicClientApplication=oo,Object.defineProperty(y,"__esModule",{value:!0})});
